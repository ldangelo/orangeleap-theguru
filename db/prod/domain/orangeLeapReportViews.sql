

-- *********************************************************************************************************************
--
-- Picklists View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_PICKLISTS;
CREATE VIEW VW_PICKLISTS
AS
	SELECT
		PICKLIST_DESC AS PICKLIST_PICKLIST_NAME,
		PICKLIST.ENTITY_TYPE AS PICKLIST_ENTITY_TYPE,
		PICKLIST.MULTISELECT AS PICKLIST_MULTISELECT,
		PICKLIST.SITE_NAME AS PICKLIST_SITE_NAME,

		PICKLIST_CUSTOM_FIELD.FIELD_NAME AS PICKLIST_CUSTOM_FIELD_FIELD_NAME,
		PICKLIST_CUSTOM_FIELD.FIELD_VALUE AS PICKLIST_CUSTOM_FIELD_FIELD_VALUE,

		PICKLIST_ITEM.ITEM_NAME AS PICKLIST_ITEM_ITEM_NAME,
		PICKLIST_ITEM.DEFAULT_DISPLAY_VALUE AS PICKLIST_ITEM_DEFAULT_DISPLAY_VALUE,
		PICKLIST_ITEM.LONG_DESCRIPTION AS PICKLIST_ITEM_LONG_DESCRIPTION,
		PICKLIST_ITEM.ITEM_ORDER AS PICKLIST_ITEM_ITEM_ORDER,
		PICKLIST_ITEM.INACTIVE AS PICKLIST_ITEM_INACTIVE,

		PICKLIST_ITEM_CUSTOM_FIELD.FIELD_NAME AS PICKLIST_ITEM_CUSTOM_FIELD_FIELD_NAME,
		PICKLIST_ITEM_CUSTOM_FIELD.FIELD_VALUE AS PICKLIST_ITEM_CUSTOM_FIELD_FIELD_VALUE
	FROM PICKLIST
	LEFT JOIN CUSTOM_FIELD PICKLIST_CUSTOM_FIELD ON PICKLIST.PICKLIST_ID = PICKLIST_CUSTOM_FIELD.ENTITY_ID AND PICKLIST_CUSTOM_FIELD.ENTITY_TYPE = 'picklist'
	LEFT JOIN PICKLIST_ITEM ON PICKLIST.PICKLIST_ID = PICKLIST_ITEM.PICKLIST_ID
	LEFT JOIN CUSTOM_FIELD PICKLIST_ITEM_CUSTOM_FIELD ON PICKLIST_ITEM.PICKLIST_ITEM_ID = PICKLIST_ITEM_CUSTOM_FIELD.ENTITY_ID AND PICKLIST_ITEM_CUSTOM_FIELD.ENTITY_TYPE = 'picklistitem'
;


-- *********************************************************************************************************************
--
-- Current Addresses View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_ADDRESSES_CURRENT;
CREATE VIEW VW_ADDRESSES_CURRENT
AS
	SELECT *
	FROM ADDRESS
	WHERE ADDRESS.UNDELIVERABLE = '0'
	AND ADDRESS.INACTIVE= '0'
	AND ((ADDRESS.ACTIVATION_STATUS = 'temporary' AND ADDRESS.TEMPORARY_START_DATE <= NOW() AND ADDRESS.TEMPORARY_END_DATE >= NOW())
	  OR (ADDRESS.ACTIVATION_STATUS = 'seasonal' AND IS_IN_SEASON(now(), SEASONAL_START_DATE, SEASONAL_END_DATE))
	  OR (ADDRESS.ACTIVATION_STATUS = 'permanent' AND ADDRESS.EFFECTIVE_DATE <= NOW()))
;


-- *********************************************************************************************************************
--
-- Constituents View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS;
CREATE VIEW VW_CONSTITUENTS
AS
	SELECT
		CONSTITUENT.CONSTITUENT_ID AS CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT.ACCOUNT_NUMBER AS CONSTITUENT_ACCOUNT_NUMBER,
		GETPICKLISTDISPLAYVALUE(CASE WHEN CONSTITUENT_TYPE = 'individual' THEN 'customFieldMap[constituentIndividualRoles]' WHEN CONSTITUENT_TYPE = 'organization' THEN 'customFieldMap[constituentOrganizationRoles]' ELSE '' END, CONSTITUENT_ROLES.FIELD_VALUE) AS CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT.CONSTITUENT_TYPE AS CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT.CREATE_DATE AS CONSTITUENT_CREATE_DATE,
		CONSTITUENT.FIRST_NAME AS CONSTITUENT_FIRST_NAME,
		GETPICKLISTDISPLAYVALUE('customFieldMap[donorProfiles]', DONOR_PROFILES.FIELD_VALUE) AS CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT.LAST_NAME AS CONSTITUENT_LAST_NAME,
		CONSTITUENT.LEGAL_NAME AS CONSTITUENT_LEGAL_NAME,
		CONSTITUENT.LOGIN_ID AS CONSTITUENT_LOGIN_ID,
		CONSTITUENT.MARITAL_STATUS AS CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT.MIDDLE_NAME AS CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT.NAICS_CODE AS CONSTITUENT_NAICS_CODE,
		CONSTITUENT.ORGANIZATION_NAME AS CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT.PREFERRED_PHONE_TYPE AS CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT.RECOGNITION_NAME AS CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT.SUFFIX AS CONSTITUENT_SUFFIX,
		CONSTITUENT.TITLE AS CONSTITUENT_TITLE,
		CONSTITUENT.UPDATE_DATE AS CONSTITUENT_UPDATE_DATE,
		CONSTITUENT.SITE_NAME AS CONSTITUENT_SITE_NAME,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_CURRENT_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CURRENT_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_CURRENT_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_CURRENT_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_CURRENT_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_CURRENT_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_CURRENT_UNDELIVERABLE
	FROM CONSTITUENT
	LEFT JOIN VW_ADDRESSES_CURRENT ADDRESS ON ADDRESS.CONSTITUENT_ID = CONSTITUENT.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'
	-- Profile Types
	LEFT JOIN CUSTOM_FIELD AS CONSTITUENT_ROLES ON CONSTITUENT_ROLES.ENTITY_TYPE = 'constituent' AND CONSTITUENT_ROLES.ENTITY_ID = CONSTITUENT.CONSTITUENT_ID AND CONSTITUENT_ROLES.FIELD_NAME =
		CASE WHEN CONSTITUENT_TYPE = 'individual' THEN 'constituentIndividualRoles' WHEN CONSTITUENT_TYPE = 'organization' THEN 'constituentOrganizationRoles' ELSE '' END
	-- Donor Profiles
	LEFT JOIN CUSTOM_FIELD AS DONOR_PROFILES ON DONOR_PROFILES.ENTITY_TYPE = 'constituent' AND DONOR_PROFILES.ENTITY_ID = CONSTITUENT.CONSTITUENT_ID AND DONOR_PROFILES.FIELD_NAME = 'donorProfiles'
;


-- *********************************************************************************************************************
--
-- Constituents & Addresses View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_ADDRESSES;
CREATE VIEW VW_CONSTITUENTS_ADDRESSES
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE
	FROM VW_CONSTITUENTS
	LEFT JOIN ADDRESS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = ADDRESS.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'
;


-- *********************************************************************************************************************
--
-- Constituents & Email Addresses View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_EMAILS;
CREATE VIEW VW_CONSTITUENTS_EMAILS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY
	FROM VW_CONSTITUENTS
	LEFT JOIN EMAIL ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = EMAIL.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'
;


-- *********************************************************************************************************************
--
-- Constituents & Phone Numbers View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PHONENUMBERS;
CREATE VIEW VW_CONSTITUENTS_PHONENUMBERS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY
	FROM VW_CONSTITUENTS
	LEFT JOIN PHONE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PHONE.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
;



-- *********************************************************************************************************************
--
-- Constituent & Contact Information
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_CONTACTINFORMATION;
CREATE VIEW VW_CONSTITUENTS_CONTACTINFORMATION
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY

	FROM VW_CONSTITUENTS
	LEFT JOIN ADDRESS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = ADDRESS.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'

	LEFT JOIN EMAIL ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = EMAIL.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'

	LEFT JOIN PHONE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PHONE.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
;



-- *********************************************************************************************************************
--
-- Constituent & Primary Contact Information
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION;
CREATE VIEW VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE

	FROM VW_CONSTITUENTS
	LEFT JOIN ADDRESS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = ADDRESS.CONSTITUENT_ID AND IFNULL(ADDRESS.IS_PRIMARY, 0) = 1
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'

	LEFT JOIN EMAIL ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = EMAIL.CONSTITUENT_ID AND IFNULL(EMAIL.IS_PRIMARY, 0) = 1
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'

	LEFT JOIN PHONE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PHONE.CONSTITUENT_ID AND IFNULL(PHONE.IS_PRIMARY, 0) = 1
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
	WHERE ADDRESS.ADDRESS_ID IS NOT NULL
	OR EMAIL.EMAIL_ID IS NOT NULL
	OR PHONE.PHONE_ID IS NOT NULL
;



-- *********************************************************************************************************************
--
-- Constituent & Receive Correspondence Contact Information
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RECEIVECORRESPONDENCECONTACTINFORMATION;
CREATE VIEW VW_CONSTITUENTS_RECEIVECORRESPONDENCECONTACTINFORMATION
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY

	FROM VW_CONSTITUENTS
	LEFT JOIN ADDRESS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = ADDRESS.CONSTITUENT_ID AND IFNULL(ADDRESS.RECEIVE_CORRESPONDENCE, 0) = 1
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'

	LEFT JOIN EMAIL ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = EMAIL.CONSTITUENT_ID AND IFNULL(EMAIL.RECEIVE_CORRESPONDENCE, 0) = 1
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'

	LEFT JOIN PHONE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PHONE.CONSTITUENT_ID AND (IFNULL(PHONE.RECEIVE_CORRESPONDENCE, 0) = 1 OR IFNULL(PHONE.RECEIVE_CORRESPONDENCE_TEXT, 0) = 1)
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
	WHERE ADDRESS.ADDRESS_ID IS NOT NULL
	OR EMAIL.EMAIL_ID IS NOT NULL
	OR PHONE.PHONE_ID IS NOT NULL
;



-- *********************************************************************************************************************
--
-- Constituent & Undeliverable Contact Information
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_UNDELIVERABLECONTACTINFORMATION;
CREATE VIEW VW_CONSTITUENTS_UNDELIVERABLECONTACTINFORMATION
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY

	FROM VW_CONSTITUENTS
	LEFT JOIN ADDRESS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = ADDRESS.CONSTITUENT_ID AND IFNULL(ADDRESS.UNDELIVERABLE, 0) = 1
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'

	LEFT JOIN EMAIL ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = EMAIL.CONSTITUENT_ID AND IFNULL(EMAIL.UNDELIVERABLE, 0) = 1
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'

	LEFT JOIN PHONE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PHONE.CONSTITUENT_ID AND IFNULL(PHONE.UNDELIVERABLE, 0) = 1
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
	WHERE ADDRESS.ADDRESS_ID IS NOT NULL
	OR EMAIL.EMAIL_ID IS NOT NULL
	OR PHONE.PHONE_ID IS NOT NULL
;



-- *********************************************************************************************************************
--
-- Constituent & Relationships View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RELATIONSHIPS;
CREATE VIEW VW_CONSTITUENTS_RELATIONSHIPS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,
		CONSTITUENT_EMPLOYERS.FIELD_VALUE AS CONSTITUENT_EMPLOYER,
		EMPLOYERS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_EMPLOYER_CUSTOM_FIELD_NAME,
		EMPLOYERS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_EMPLOYER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_HOUSEHOLD_MEMBERS.FIELD_VALUE AS CONSTITUENT_HOUSEHOLD_MEMBER,
		HOUSEHOLD_MEMBERS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_NAME,
		HOUSEHOLD_MEMBERS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PARENTS.FIELD_VALUE AS CONSTITUENT_PARENT,
		PARENTS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_PARENT_CUSTOM_FIELD_NAME,
		PARENTS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_PARENT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_CHILDREN.FIELD_VALUE AS CONSTITUENT_CHILD,
		CHILDREN_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_CHILD_CUSTOM_FIELD_NAME,
		CHILDREN_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_CHILD_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SIBLINGS.FIELD_VALUE AS CONSTITUENT_SIBLING,
		SIBLINGS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_SIBLING_CUSTOM_FIELD_NAME,
		SIBLINGS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_SIBLING_CUSTOM_FIELD_VALUE,

		CONSTITUENT_FRIENDS.FIELD_VALUE AS CONSTITUENT_FRIEND,
		FRIENDS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_FRIEND_CUSTOM_FIELD_NAME,
		FRIENDS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_FRIEND_CUSTOM_FIELD_VALUE,

		CONSTITUENT_EMPLOYEES.FIELD_VALUE AS CONSTITUENT_EMPLOYEE,
		EMPLOYEES_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_NAME,
		EMPLOYEES_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SUBSIDIARYLIST.FIELD_VALUE AS CONSTITUENT_SUBSIDIARY,
		SUBSIDIARYLIST_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_NAME,
		SUBSIDIARYLIST_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PRIMARYCONTACTS.FIELD_VALUE AS CONSTITUENT_PRIMARYCONTACT,
		PRIMARYCONTACTS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_NAME,
		PRIMARYCONTACTS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_BILLINGCONTACTS.FIELD_VALUE AS CONSTITUENT_BILLINGCONTACT,
		BILLINGCONTACTS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_NAME,
		BILLINGCONTACTS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SALESCONTACTS.FIELD_VALUE AS CONSTITUENT_SALESCONTACT,
		SALESCONTACTS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_NAME,
		SALESCONTACTS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PUBLICRELATIONSCONTACTS.FIELD_VALUE AS CONSTITUENT_PUBLICRELATIONSCONTACT,
		PUBLICRELATIONSCONTACTS_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_NAME,
		PUBLICRELATIONSCONTACTS_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_VALUE,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE
	FROM VW_CONSTITUENTS
	LEFT JOIN CUSTOM_FIELD CONSTITUENT_EMPLOYERS ON CONSTITUENT_EMPLOYERS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_EMPLOYERS.FIELD_NAME = 'individual.organizations' AND CONSTITUENT_EMPLOYERS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYERS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYERS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYERS.CUSTOM_FIELD_VALUE = CONSTITUENT_EMPLOYERS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYERS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_EMPLOYERS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD EMPLOYERS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYERS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = EMPLOYERS_CUSTOM_FIELD.ENTITY_ID AND EMPLOYERS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_HOUSEHOLD_MEMBERS ON CONSTITUENT_HOUSEHOLD_MEMBERS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_HOUSEHOLD_MEMBERS.FIELD_NAME = 'headOfHousehold.householdMembers' AND CONSTITUENT_HOUSEHOLD_MEMBERS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_HOUSEHOLD_MEMBERS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_HOUSEHOLD_MEMBERS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_HOUSEHOLD_MEMBERS.CUSTOM_FIELD_VALUE = CONSTITUENT_HOUSEHOLD_MEMBERS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_HOUSEHOLD_MEMBERS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_HOUSEHOLD_MEMBERS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD HOUSEHOLD_MEMBERS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_HOUSEHOLD_MEMBERS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = HOUSEHOLD_MEMBERS_CUSTOM_FIELD.ENTITY_ID AND HOUSEHOLD_MEMBERS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_PARENTS ON CONSTITUENT_PARENTS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_PARENTS.FIELD_NAME = 'individual.parents' AND CONSTITUENT_PARENTS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PARENTS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PARENTS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PARENTS.CUSTOM_FIELD_VALUE = CONSTITUENT_PARENTS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PARENTS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_PARENTS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD PARENTS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PARENTS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = PARENTS_CUSTOM_FIELD.ENTITY_ID AND PARENTS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_CHILDREN ON CONSTITUENT_CHILDREN.ENTITY_TYPE = 'constituent' AND CONSTITUENT_CHILDREN.FIELD_NAME = 'individual.children' AND CONSTITUENT_CHILDREN.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_CHILDREN ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_CHILDREN.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_CHILDREN.CUSTOM_FIELD_VALUE = CONSTITUENT_CHILDREN.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_CHILDREN.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_CHILDREN.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD CHILDREN_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_CHILDREN.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = CHILDREN_CUSTOM_FIELD.ENTITY_ID AND CHILDREN_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_SIBLINGS ON CONSTITUENT_SIBLINGS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_SIBLINGS.FIELD_NAME = 'individual.siblings' AND CONSTITUENT_SIBLINGS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SIBLINGS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SIBLINGS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SIBLINGS.CUSTOM_FIELD_VALUE = CONSTITUENT_SIBLINGS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SIBLINGS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_SIBLINGS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD SIBLINGS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SIBLINGS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = SIBLINGS_CUSTOM_FIELD.ENTITY_ID AND SIBLINGS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_FRIENDS ON CONSTITUENT_FRIENDS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_FRIENDS.FIELD_NAME = 'individual.friends' AND CONSTITUENT_FRIENDS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_FRIENDS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_FRIENDS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_FRIENDS.CUSTOM_FIELD_VALUE = CONSTITUENT_FRIENDS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_FRIENDS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_FRIENDS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD FRIENDS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_FRIENDS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = FRIENDS_CUSTOM_FIELD.ENTITY_ID AND FRIENDS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_EMPLOYEES ON CONSTITUENT_EMPLOYEES.ENTITY_TYPE = 'constituent' AND CONSTITUENT_EMPLOYEES.FIELD_NAME = 'organization.employees' AND CONSTITUENT_EMPLOYEES.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYEES ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYEES.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYEES.CUSTOM_FIELD_VALUE = CONSTITUENT_EMPLOYEES.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYEES.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_EMPLOYEES.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD EMPLOYEES_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_EMPLOYEES.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = EMPLOYEES_CUSTOM_FIELD.ENTITY_ID AND EMPLOYEES_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_SUBSIDIARYLIST ON CONSTITUENT_SUBSIDIARYLIST.ENTITY_TYPE = 'constituent' AND CONSTITUENT_SUBSIDIARYLIST.FIELD_NAME = 'organization.subsidiaryList' AND CONSTITUENT_SUBSIDIARYLIST.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SUBSIDIARYLIST ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SUBSIDIARYLIST.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SUBSIDIARYLIST.CUSTOM_FIELD_VALUE = CONSTITUENT_SUBSIDIARYLIST.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SUBSIDIARYLIST.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_SUBSIDIARYLIST.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD SUBSIDIARYLIST_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SUBSIDIARYLIST.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = SUBSIDIARYLIST_CUSTOM_FIELD.ENTITY_ID AND SUBSIDIARYLIST_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_PRIMARYCONTACTS ON CONSTITUENT_PRIMARYCONTACTS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_PRIMARYCONTACTS.FIELD_NAME = 'organization.primaryContacts' AND CONSTITUENT_PRIMARYCONTACTS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PRIMARYCONTACTS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PRIMARYCONTACTS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PRIMARYCONTACTS.CUSTOM_FIELD_VALUE = CONSTITUENT_PRIMARYCONTACTS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PRIMARYCONTACTS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_PRIMARYCONTACTS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD PRIMARYCONTACTS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PRIMARYCONTACTS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = PRIMARYCONTACTS_CUSTOM_FIELD.ENTITY_ID AND PRIMARYCONTACTS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_BILLINGCONTACTS ON CONSTITUENT_BILLINGCONTACTS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_BILLINGCONTACTS.FIELD_NAME = 'organization.billingContacts' AND CONSTITUENT_BILLINGCONTACTS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_BILLINGCONTACTS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_BILLINGCONTACTS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_BILLINGCONTACTS.CUSTOM_FIELD_VALUE = CONSTITUENT_BILLINGCONTACTS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_BILLINGCONTACTS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_BILLINGCONTACTS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD BILLINGCONTACTS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_BILLINGCONTACTS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = BILLINGCONTACTS_CUSTOM_FIELD.ENTITY_ID AND BILLINGCONTACTS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_SALESCONTACTS ON CONSTITUENT_SALESCONTACTS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_SALESCONTACTS.FIELD_NAME = 'organization.salesContacts' AND CONSTITUENT_SALESCONTACTS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SALESCONTACTS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SALESCONTACTS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SALESCONTACTS.CUSTOM_FIELD_VALUE = CONSTITUENT_SALESCONTACTS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SALESCONTACTS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_SALESCONTACTS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD SALESCONTACTS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_SALESCONTACTS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = SALESCONTACTS_CUSTOM_FIELD.ENTITY_ID AND SALESCONTACTS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'

	LEFT JOIN CUSTOM_FIELD CONSTITUENT_PUBLICRELATIONSCONTACTS ON CONSTITUENT_PUBLICRELATIONSCONTACTS.ENTITY_TYPE = 'constituent' AND CONSTITUENT_PUBLICRELATIONSCONTACTS.FIELD_NAME = 'organization.publicRelationsContacts' AND CONSTITUENT_PUBLICRELATIONSCONTACTS.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PUBLICRELATIONSCONTACTS ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PUBLICRELATIONSCONTACTS.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PUBLICRELATIONSCONTACTS.CUSTOM_FIELD_VALUE = CONSTITUENT_PUBLICRELATIONSCONTACTS.FIELD_VALUE AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PUBLICRELATIONSCONTACTS.MASTER_FIELD_DEFINITION_ID = CONCAT('constituent.customFieldMap[', CONSTITUENT_PUBLICRELATIONSCONTACTS.FIELD_NAME, ']')
	LEFT JOIN CUSTOM_FIELD PUBLICRELATIONSCONTACTS_CUSTOM_FIELD ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_PUBLICRELATIONSCONTACTS.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = PUBLICRELATIONSCONTACTS_CUSTOM_FIELD.ENTITY_ID AND PUBLICRELATIONSCONTACTS_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'
;



-- *********************************************************************************************************************
--
-- Constituent & Relationship Details View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RELATIONSHIP_DETAILS;
CREATE VIEW VW_CONSTITUENTS_RELATIONSHIP_DETAILS
AS
	SELECT
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID,
		VW_CONSTITUENTS.CONSTITUENT_ACCOUNT_NUMBER,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ROLE,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_CREATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_FIRST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_DONOR_PROFILE,
		VW_CONSTITUENTS.CONSTITUENT_LAST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LEGAL_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LOGIN_ID,
		VW_CONSTITUENTS.CONSTITUENT_MARITAL_STATUS,
		VW_CONSTITUENTS.CONSTITUENT_MIDDLE_NAME,
		VW_CONSTITUENTS.CONSTITUENT_NAICS_CODE,
		VW_CONSTITUENTS.CONSTITUENT_ORGANIZATION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_PREFERRED_PHONE_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_RECOGNITION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_SUFFIX,
		VW_CONSTITUENTS.CONSTITUENT_TITLE,
		VW_CONSTITUENTS.CONSTITUENT_UPDATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_SITE_NAME,

		-- Current Address
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_ID,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_TYPE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ACTIVATION_STATUS,
		VW_CONSTITUENTS.ADDRESS_CURRENT_EFFECTIVE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_1,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_2,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_3,
		VW_CONSTITUENTS.ADDRESS_CURRENT_CITY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_STATE_PROVINCE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_COUNTRY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_POSTAL_CODE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_COMMENT,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_END_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_START_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_TEMPORARY_END_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_TEMPORARY_START_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_CREATE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_UPDATE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_INACTIVE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_IS_PRIMARY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_UNDELIVERABLE,

    (SELECT DEFAULT_LABEL FROM FIELD_DEFINITION WHERE FIELD_DEFINITION_ID LIKE CONCAT('%constituent.customFieldMap[', CONSTITUENT_RELATIONSHIP.FIELD_NAME, ']')) AS CONSTITUENT_RELATIONSHIP_TYPE,
		CONSTITUENT_RELATIONSHIP.FIELD_VALUE AS CONSTITUENT_RELATIONSHIP_CONSTITUENT_ID,
		RELATIONSHIP_CUSTOM_FIELD.FIELD_NAME AS CONSTITUENT_RELATIONSHIP_CUSTOM_FIELD_NAME,
		RELATIONSHIP_CUSTOM_FIELD.FIELD_VALUE AS CONSTITUENT_RELATIONSHIP_CUSTOM_FIELD_VALUE,

		RELATED_CONSTITUENT.CONSTITUENT_CONSTITUENT_ID AS RELATED_CONSTITUENT_CONSTITUENT_ID,
		RELATED_CONSTITUENT.CONSTITUENT_ACCOUNT_NUMBER AS RELATED_CONSTITUENT_ACCOUNT_NUMBER,
		RELATED_CONSTITUENT.CONSTITUENT_CONSTITUENT_ROLE AS RELATED_CONSTITUENT_CONSTITUENT_ROLE,
		RELATED_CONSTITUENT.CONSTITUENT_CONSTITUENT_TYPE AS RELATED_CONSTITUENT_CONSTITUENT_TYPE,
		RELATED_CONSTITUENT.CONSTITUENT_CREATE_DATE AS RELATED_CONSTITUENT_CREATE_DATE,
		RELATED_CONSTITUENT.CONSTITUENT_FIRST_NAME AS RELATED_CONSTITUENT_FIRST_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_DONOR_PROFILE AS RELATED_CONSTITUENT_DONOR_PROFILE,
		RELATED_CONSTITUENT.CONSTITUENT_LAST_NAME AS RELATED_CONSTITUENT_LAST_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_LEGAL_NAME AS RELATED_CONSTITUENT_LEGAL_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_LOGIN_ID AS RELATED_CONSTITUENT_LOGIN_ID,
		RELATED_CONSTITUENT.CONSTITUENT_MARITAL_STATUS AS RELATED_CONSTITUENT_MARITAL_STATUS,
		RELATED_CONSTITUENT.CONSTITUENT_MIDDLE_NAME AS RELATED_CONSTITUENT_MIDDLE_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_NAICS_CODE AS RELATED_CONSTITUENT_NAICS_CODE,
		RELATED_CONSTITUENT.CONSTITUENT_ORGANIZATION_NAME AS RELATED_CONSTITUENT_ORGANIZATION_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_PREFERRED_PHONE_TYPE AS RELATED_CONSTITUENT_PREFERRED_PHONE_TYPE,
		RELATED_CONSTITUENT.CONSTITUENT_RECOGNITION_NAME AS RELATED_CONSTITUENT_RECOGNITION_NAME,
		RELATED_CONSTITUENT.CONSTITUENT_SUFFIX AS RELATED_CONSTITUENT_SUFFIX,
		RELATED_CONSTITUENT.CONSTITUENT_TITLE AS RELATED_CONSTITUENT_TITLE,
		RELATED_CONSTITUENT.CONSTITUENT_UPDATE_DATE AS RELATED_CONSTITUENT_UPDATE_DATE,
		RELATED_CONSTITUENT.CONSTITUENT_SITE_NAME AS RELATED_CONSTITUENT_SITE_NAME,

		-- Current Address
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ADDRESS_ID AS RELATED_ADDRESS_CURRENT_ADDRESS_ID,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ADDRESS_TYPE AS RELATED_ADDRESS_CURRENT_ADDRESS_TYPE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ACTIVATION_STATUS AS RELATED_ADDRESS_CURRENT_ACTIVATION_STATUS,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_EFFECTIVE_DATE AS RELATED_ADDRESS_CURRENT_EFFECTIVE_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ADDRESS_LINE_1 AS RELATED_ADDRESS_CURRENT_ADDRESS_LINE_1,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ADDRESS_LINE_2 AS RELATED_ADDRESS_CURRENT_ADDRESS_LINE_2,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_ADDRESS_LINE_3 AS RELATED_ADDRESS_CURRENT_ADDRESS_LINE_3,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_CITY AS RELATED_ADDRESS_CURRENT_CITY,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_STATE_PROVINCE AS RELATED_ADDRESS_CURRENT_STATE_PROVINCE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_COUNTRY AS RELATED_ADDRESS_CURRENT_COUNTRY,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_POSTAL_CODE AS RELATED_ADDRESS_CURRENT_POSTAL_CODE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE AS RELATED_ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_COMMENT AS RELATED_ADDRESS_CURRENT_COMMENT,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_SEASONAL_END_DATE AS RELATED_ADDRESS_CURRENT_SEASONAL_END_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_SEASONAL_START_DATE AS RELATED_ADDRESS_CURRENT_SEASONAL_START_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY AS RELATED_ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY AS RELATED_ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_TEMPORARY_END_DATE AS RELATED_ADDRESS_CURRENT_TEMPORARY_END_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_TEMPORARY_START_DATE AS RELATED_ADDRESS_CURRENT_TEMPORARY_START_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_CREATE_DATE AS RELATED_ADDRESS_CURRENT_CREATE_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_UPDATE_DATE AS RELATED_ADDRESS_CURRENT_UPDATE_DATE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_INACTIVE AS RELATED_ADDRESS_CURRENT_INACTIVE,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_IS_PRIMARY AS RELATED_ADDRESS_CURRENT_IS_PRIMARY,
		RELATED_CONSTITUENT.ADDRESS_CURRENT_UNDELIVERABLE AS RELATED_ADDRESS_CURRENT_UNDELIVERABLE
	FROM VW_CONSTITUENTS
	LEFT JOIN CUSTOM_FIELD CONSTITUENT_RELATIONSHIP
    ON CONSTITUENT_RELATIONSHIP.ENTITY_TYPE = 'constituent'
    AND CONSTITUENT_RELATIONSHIP.FIELD_NAME IN
      (SELECT REPLACE(REPLACE(FIELD_NAME, 'customFieldMap[', ''), ']', '') FROM FIELD_DEFINITION F
      WHERE REFERENCE_TYPE = 'constituent' AND FIELD_DEFINITION_ID LIKE '%constituent.%')
    AND CONSTITUENT_RELATIONSHIP.ENTITY_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
	LEFT JOIN CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP
    ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
    AND CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.CUSTOM_FIELD_VALUE = CONSTITUENT_RELATIONSHIP.FIELD_VALUE
    AND (CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.MASTER_FIELD_DEFINITION_ID LIKE CONCAT('%constituent.customFieldMap[', CONSTITUENT_RELATIONSHIP.FIELD_NAME, ']')
     OR CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.MASTER_FIELD_DEFINITION_ID IN (SELECT DETAIL_FIELD_DEFINITION_ID FROM FIELD_RELATIONSHIP WHERE MASTER_FIELD_DEFINITION_ID LIKE CONCAT('%constituent.customFieldMap[', CONSTITUENT_RELATIONSHIP.FIELD_NAME, ']'))
     OR CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.MASTER_FIELD_DEFINITION_ID IN (SELECT MASTER_FIELD_DEFINITION_ID FROM FIELD_RELATIONSHIP WHERE DETAIL_FIELD_DEFINITION_ID LIKE CONCAT('%constituent.customFieldMap[', CONSTITUENT_RELATIONSHIP.FIELD_NAME, ']')))
	LEFT JOIN CUSTOM_FIELD RELATIONSHIP_CUSTOM_FIELD
  	ON CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP.CONSTITUENT_CUSTOM_FIELD_RELATIONSHIP_ID = RELATIONSHIP_CUSTOM_FIELD.ENTITY_ID
	  AND RELATIONSHIP_CUSTOM_FIELD.ENTITY_TYPE = 'constituentcustomfieldrelationship'
	LEFT JOIN VW_CONSTITUENTS RELATED_CONSTITUENT ON RELATED_CONSTITUENT.CONSTITUENT_CONSTITUENT_ID = CONSTITUENT_RELATIONSHIP.FIELD_VALUE
;



-- *********************************************************************************************************************
--
-- Pledges & Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_PLEDGES_DISTRIBUTIONS;
CREATE VIEW VW_PLEDGES_DISTRIBUTIONS
AS
	SELECT
		COMMITMENT.CONSTITUENT_ID AS COMMITMENT_CONSTITUENT_ID,
		COMMITMENT.PLEDGE_ID AS COMMITMENT_COMMITMENT_ID,
		COMMITMENT.RECURRING AS COMMITMENT_RECURRING,
		COMMITMENT.AMOUNT_PER_GIFT AS COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT.AMOUNT_TOTAL AS COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT.CURRENCY_CODE AS COMMITMENT_CURRENCY_CODE,
		COMMITMENT.PLEDGE_STATUS AS COMMITMENT_STATUS,
		COMMITMENT.FREQUENCY AS COMMITMENT_FREQUENCY,
		COMMITMENT.PLEDGE_DATE AS COMMITMENT_PLEDGE_DATE,
		COMMITMENT.PROJECTED_DATE AS COMMITMENT_PROJECTED_DATE,
		COMMITMENT.START_DATE AS COMMITMENT_START_DATE,
		COMMITMENT.END_DATE AS COMMITMENT_END_DATE,
		COMMITMENT.COMMENTS AS COMMITMENT_COMMENTS,

		-- Gift Distribution Line Information
		DISTRO_LINE.DISTRO_LINE_ID AS DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE.AMOUNT AS DISTRO_LINE_AMOUNT,
		DISTRO_LINE.PERCENTAGE AS DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE.PROJECT_CODE AS DISTRO_LINE_PROJECT_CODE,
		IFNULL(DISTRO_LINE.MOTIVATION_CODE, DISTRO_LINE.OTHER_MOTIVATION) AS DISTRO_LINE_MOTIVATION_CODE
	FROM PLEDGE AS COMMITMENT
	LEFT JOIN DISTRO_LINE ON COMMITMENT.PLEDGE_ID = DISTRO_LINE.PLEDGE_ID
	LEFT JOIN CONSTITUENT ON CONSTITUENT.CONSTITUENT_ID = COMMITMENT.CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Recurring Gifts View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_RECURRINGGIFTS;
CREATE VIEW VW_RECURRINGGIFTS
AS
	SELECT
		COMMITMENT.RECURRING_GIFT_ID AS COMMITMENT_COMMITMENT_ID,
		COMMITMENT.CONSTITUENT_ID AS COMMITMENT_CONSTITUENT_ID,
		COMMITMENT.AUTO_PAY AS COMMITMENT_AUTO_PAY,
		COMMITMENT.AMOUNT_PER_GIFT AS COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT.AMOUNT_TOTAL AS COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT.CURRENCY_CODE AS COMMITMENT_CURRENCY_CODE,
		COMMITMENT.FREQUENCY AS COMMITMENT_FREQUENCY,
		COMMITMENT.START_DATE AS COMMITMENT_START_DATE,
		COMMITMENT.END_DATE AS COMMITMENT_END_DATE,
		COMMITMENT.RECURRING_GIFT_STATUS AS COMMITMENT_STATUS,
		COMMITMENT.COMMENTS AS COMMITMENT_COMMENTS,
		COMMITMENT.CREATE_DATE AS COMMITMENT_CREATE_DATE,
		COMMITMENT.UPDATE_DATE AS COMMITMENT_UPDATE_DATE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_PROFILE AS COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		COMMITMENT.PAYMENT_TYPE AS COMMITMENT_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		COMMITMENT.CHECK_NUMBER AS COMMITMENT_CHECK_NUMBER,
		-- Payment Address
		COMMITMENT_PAYMENT_ADDRESS.IS_PRIMARY AS COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		COMMITMENT_PAYMENT_ADDRESS.UNDELIVERABLE AS COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		COMMITMENT_PAYMENT_ADDRESS.INACTIVE AS COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_1 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_2 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_3 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		COMMITMENT_PAYMENT_ADDRESS.CITY AS COMMITMENT_PAYMENT_ADDRESS_CITY,
		COMMITMENT_PAYMENT_ADDRESS.STATE_PROVINCE AS COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		COMMITMENT_PAYMENT_ADDRESS.POSTAL_CODE AS COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		COMMITMENT_PAYMENT_ADDRESS.COUNTRY AS COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
			-- Payment Phone
		COMMITMENT_PAYMENT_PHONE.NUMBER AS COMMITMENT_PAYMENT_PHONE_NUMBER,
		COMMITMENT_PAYMENT_PHONE.IS_PRIMARY AS COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		COMMITMENT_PAYMENT_PHONE.UNDELIVERABLE AS COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		COMMITMENT_PAYMENT_PHONE.INACTIVE AS COMMITMENT_PAYMENT_PHONE_INACTIVE
	FROM RECURRING_GIFT AS COMMITMENT
	LEFT JOIN PAYMENT_SOURCE ON COMMITMENT.PAYMENT_SOURCE_ID = PAYMENT_SOURCE.PAYMENT_SOURCE_ID
	LEFT JOIN ADDRESS COMMITMENT_PAYMENT_ADDRESS ON COMMITMENT.ADDRESS_ID = COMMITMENT_PAYMENT_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE COMMITMENT_PAYMENT_PHONE ON COMMITMENT.PHONE_ID = COMMITMENT_PAYMENT_PHONE.PHONE_ID
;


-- *********************************************************************************************************************
--
-- Recurring Gifts & Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_RECURRINGGIFTS_DISTRIBUTIONS;
CREATE VIEW VW_RECURRINGGIFTS_DISTRIBUTIONS
AS
	SELECT
		COMMITMENT.RECURRING_GIFT_ID AS COMMITMENT_COMMITMENT_ID,
		COMMITMENT.CONSTITUENT_ID AS COMMITMENT_CONSTITUENT_ID,
		COMMITMENT.AUTO_PAY AS COMMITMENT_AUTO_PAY,
		COMMITMENT.AMOUNT_PER_GIFT AS COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT.AMOUNT_TOTAL AS COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT.CURRENCY_CODE AS COMMITMENT_CURRENCY_CODE,
		COMMITMENT.FREQUENCY AS COMMITMENT_FREQUENCY,
		COMMITMENT.START_DATE AS COMMITMENT_START_DATE,
		COMMITMENT.END_DATE AS COMMITMENT_END_DATE,
		COMMITMENT.RECURRING_GIFT_STATUS AS COMMITMENT_STATUS,
		COMMITMENT.COMMENTS AS COMMITMENT_COMMENTS,
		-- COMMITMENT.RECURRING AS COMMITMENT_RECURRING,
		COMMITMENT.CREATE_DATE AS COMMITMENT_CREATE_DATE,
		COMMITMENT.UPDATE_DATE AS COMMITMENT_UPDATE_DATE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_PROFILE AS COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		COMMITMENT.PAYMENT_TYPE AS COMMITMENT_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		COMMITMENT.CHECK_NUMBER AS COMMITMENT_CHECK_NUMBER,
		-- Payment Address
		COMMITMENT_PAYMENT_ADDRESS.IS_PRIMARY AS COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		COMMITMENT_PAYMENT_ADDRESS.UNDELIVERABLE AS COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		COMMITMENT_PAYMENT_ADDRESS.INACTIVE AS COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_1 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_2 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		COMMITMENT_PAYMENT_ADDRESS.ADDRESS_LINE_3 AS COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		COMMITMENT_PAYMENT_ADDRESS.CITY AS COMMITMENT_PAYMENT_ADDRESS_CITY,
		COMMITMENT_PAYMENT_ADDRESS.STATE_PROVINCE AS COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		COMMITMENT_PAYMENT_ADDRESS.POSTAL_CODE AS COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		COMMITMENT_PAYMENT_ADDRESS.COUNTRY AS COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		-- Payment Phone
		COMMITMENT_PAYMENT_PHONE.NUMBER AS COMMITMENT_PAYMENT_PHONE_NUMBER,
		COMMITMENT_PAYMENT_PHONE.IS_PRIMARY AS COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		COMMITMENT_PAYMENT_PHONE.UNDELIVERABLE AS COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		COMMITMENT_PAYMENT_PHONE.INACTIVE AS COMMITMENT_PAYMENT_PHONE_INACTIVE,

		-- Gift Distribution Line Information
		DISTRO_LINE.DISTRO_LINE_ID AS DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE.AMOUNT AS DISTRO_LINE_AMOUNT,
		DISTRO_LINE.PERCENTAGE AS DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE.PROJECT_CODE AS DISTRO_LINE_PROJECT_CODE,
		IFNULL(DISTRO_LINE.MOTIVATION_CODE, DISTRO_LINE.OTHER_MOTIVATION) AS DISTRO_LINE_MOTIVATION_CODE
	FROM RECURRING_GIFT AS COMMITMENT
	LEFT JOIN PAYMENT_SOURCE ON COMMITMENT.PAYMENT_SOURCE_ID = PAYMENT_SOURCE.PAYMENT_SOURCE_ID
	LEFT JOIN ADDRESS COMMITMENT_PAYMENT_ADDRESS ON COMMITMENT.ADDRESS_ID = COMMITMENT_PAYMENT_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE COMMITMENT_PAYMENT_PHONE ON COMMITMENT.PHONE_ID = COMMITMENT_PAYMENT_PHONE.PHONE_ID
	LEFT JOIN DISTRO_LINE ON COMMITMENT.RECURRING_GIFT_ID = DISTRO_LINE.RECURRING_GIFT_ID
	LEFT JOIN CONSTITUENT ON CONSTITUENT.CONSTITUENT_ID = COMMITMENT.CONSTITUENT_ID
;



-- *********************************************************************************************************************
--
-- Gifts View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_GIFTS;
CREATE VIEW VW_GIFTS
AS
	SELECT
		GIFT.CONSTITUENT_ID AS GIFT_CONSTITUENT_ID,
		GIFT.GIFT_ID AS GIFT_GIFT_ID,
		GIFT.AMOUNT AS GIFT_AMOUNT,
		GIFT.CURRENCY_CODE AS GIFT_CURRENCY_CODE,
		GIFT.DONATION_DATE AS GIFT_DONATION_DATE,
		GIFT.POSTMARK_DATE AS GIFT_POSTMARK_DATE,
		GIFT.COMMENTS AS GIFT_COMMENTS,
		GIFT.TRANSACTION_DATE AS GIFT_TRANSACTIONDATE,
		GIFT.GIFT_STATUS AS GIFT_GIFT_STATUS,
		GIFT.GIFT_TYPE AS GIFT_GIFT_TYPE,
		GIFT.AVS_MESSAGE AS GIFT_AVS_MESSAGE,
		GIFT.DEDUCTIBLE_AMOUNT AS GIFT_DEDUCTIBLE_AMOUNT,
		GIFT.ENTRY_TYPE AS GIFT_ENTRY_TYPE,
		GIFT.ORIGINAL_GIFT_ID AS GIFT_ORIGINAL_GIFT_ID,
		GIFT.PAYMENT_MESSAGE AS GIFT_PAYMENT_MESSAGE,
		GIFT.PAYMENT_STATUS AS GIFT_PAYMENT_STATUS,
		GIFT.POSTED AS GIFT_POSTED,
		GIFT.POSTED_DATE AS GIFT_POSTED_DATE,
		GIFT.PAYMENT_TXREFNUM AS GIFT_PAYMENT_TXREFNUM,
		GIFT.ADDRESS_ID AS GIFT_ADDRESS_ID,
		GIFT.PAYMENT_SOURCE_ID AS GIFT_PAYMENT_SOURCE_ID,
		GIFT.PHONE_ID AS GIFT_PHONE_ID,
		GIFT.CREATE_DATE AS GIFT_CREATE_DATE,
		GIFT.UPDATE_DATE AS GIFT_UPDATE_DATE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_PROFILE AS GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT.PAYMENT_TYPE AS GIFT_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT.CHECK_NUMBER AS GIFT_CHECK_NUMBER,
		AUTH_CODE AS GIFT_AUTH_CODE,

		-- Payment Address
		GIFT_PAYMENT_ADDRESS.INACTIVE AS GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS.IS_PRIMARY AS GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS.UNDELIVERABLE AS GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_1 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_2 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_3 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS.CITY AS GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS.STATE_PROVINCE AS GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS.POSTAL_CODE AS GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS.COUNTRY AS GIFT_PAYMENT_ADDRESS_COUNTRY,
			-- Payment Phone
		GIFT_PAYMENT_PHONE.NUMBER AS GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE.IS_PRIMARY AS GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE.UNDELIVERABLE AS GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE.INACTIVE AS GIFT_PAYMENT_PHONE_INACTIVE,

	    -- Associated Pledge Information
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_RECURRING AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_AMOUNT_PER_GIFT AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_AMOUNT_TOTAL AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_CURRENCY_CODE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_STATUS AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_FREQUENCY AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_PLEDGE_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_PROJECTED_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_START_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_END_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMENTS AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,

	    -- Associated Recurring Gift Information
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID AS VW_RGD_COMMITMENT_COMMITMENT_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID AS VW_RGD_COMMITMENT_CONSTITUENT_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AUTO_PAY AS VW_RGD_COMMITMENT_AUTO_PAY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AMOUNT_PER_GIFT AS VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AMOUNT_TOTAL AS VW_RGD_COMMITMENT_AMOUNT_TOTAL,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CURRENCY_CODE AS VW_RGD_COMMITMENT_CURRENCY_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_FREQUENCY AS VW_RGD_COMMITMENT_FREQUENCY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_START_DATE AS VW_RGD_COMMITMENT_START_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_END_DATE AS VW_RGD_COMMITMENT_END_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_STATUS AS VW_RGD_COMMITMENT_STATUS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMENTS AS VW_RGD_COMMITMENT_COMMENTS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CREATE_DATE AS VW_RGD_COMMITMENT_CREATE_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_UPDATE_DATE AS VW_RGD_COMMITMENT_UPDATE_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_TYPE AS VW_RGD_COMMITMENT_PAYMENT_TYPE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CHECK_NUMBER AS VW_RGD_COMMITMENT_CHECK_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_CITY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_COUNTRY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_NUMBER AS VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_IS_PRIMARY AS VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE AS VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_RGD_DISTRO_LINE_AMOUNT,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_RGD_DISTRO_LINE_PERCENTAGE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_RGD_DISTRO_LINE_PROJECT_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_RGD_DISTRO_LINE_MOTIVATION_CODE
	FROM GIFT
	LEFT JOIN PAYMENT_SOURCE ON GIFT.PAYMENT_SOURCE_ID = PAYMENT_SOURCE.PAYMENT_SOURCE_ID
	LEFT JOIN ADDRESS GIFT_PAYMENT_ADDRESS ON GIFT.ADDRESS_ID = GIFT_PAYMENT_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE GIFT_PAYMENT_PHONE ON GIFT.PHONE_ID = GIFT_PAYMENT_PHONE.PHONE_ID
	LEFT JOIN DISTRO_LINE ON DISTRO_LINE.GIFT_ID = GIFT.GIFT_ID
	LEFT JOIN CUSTOM_FIELD CUSTOM_FIELD_ASSOCIATEDPLEDGE ON CUSTOM_FIELD_ASSOCIATEDPLEDGE.FIELD_NAME = 'associatedPledgeId'
		AND CUSTOM_FIELD_ASSOCIATEDPLEDGE.ENTITY_TYPE = 'distributionline'
		AND DISTRO_LINE.DISTRO_LINE_ID = CUSTOM_FIELD_ASSOCIATEDPLEDGE.ENTITY_ID
	LEFT JOIN VW_PLEDGES_DISTRIBUTIONS ON VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID = CUSTOM_FIELD_ASSOCIATEDPLEDGE.FIELD_VALUE
	LEFT JOIN CUSTOM_FIELD CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT ON CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.FIELD_NAME = 'associatedRecurringGiftId'
		AND CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.ENTITY_TYPE = 'distributionline'
		AND DISTRO_LINE.DISTRO_LINE_ID = CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.ENTITY_ID
	LEFT JOIN VW_RECURRINGGIFTS_DISTRIBUTIONS ON VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID = CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.FIELD_VALUE
;



-- *********************************************************************************************************************
--
-- Gifts & Gift Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_GIFTS_DISTRIBUTIONS;
CREATE VIEW VW_GIFTS_DISTRIBUTIONS
AS
	SELECT
		GIFT.CONSTITUENT_ID AS GIFT_CONSTITUENT_ID,
		GIFT.GIFT_ID AS GIFT_GIFT_ID,
		GIFT.AMOUNT AS GIFT_AMOUNT,
		GIFT.CURRENCY_CODE AS GIFT_CURRENCY_CODE,
		GIFT.DONATION_DATE AS GIFT_DONATION_DATE,
		GIFT.POSTMARK_DATE AS GIFT_POSTMARK_DATE,
		GIFT.COMMENTS AS GIFT_COMMENTS,
		GIFT.TRANSACTION_DATE AS GIFT_TRANSACTIONDATE,
		GIFT.GIFT_STATUS AS GIFT_GIFT_STATUS,
		GIFT.GIFT_TYPE AS GIFT_GIFT_TYPE,
		GIFT.AVS_MESSAGE AS GIFT_AVS_MESSAGE,
		GIFT.DEDUCTIBLE_AMOUNT AS GIFT_DEDUCTIBLE_AMOUNT,
		GIFT.ENTRY_TYPE AS GIFT_ENTRY_TYPE,
		GIFT.ORIGINAL_GIFT_ID AS GIFT_ORIGINAL_GIFT_ID,
		GIFT.PAYMENT_MESSAGE AS GIFT_PAYMENT_MESSAGE,
		GIFT.PAYMENT_STATUS AS GIFT_PAYMENT_STATUS,
		GIFT.POSTED AS GIFT_POSTED,
		GIFT.POSTED_DATE AS GIFT_POSTED_DATE,
		GIFT.PAYMENT_TXREFNUM AS GIFT_PAYMENT_TXREFNUM,
		GIFT.ADDRESS_ID AS GIFT_ADDRESS_ID,
		GIFT.PAYMENT_SOURCE_ID AS GIFT_PAYMENT_SOURCE_ID,
		GIFT.PHONE_ID AS GIFT_PHONE_ID,
		GIFT.CREATE_DATE AS GIFT_CREATE_DATE,
		GIFT.UPDATE_DATE AS GIFT_UPDATE_DATE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_PROFILE AS GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT.PAYMENT_TYPE AS GIFT_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT.CHECK_NUMBER AS GIFT_CHECK_NUMBER,
		AUTH_CODE AS GIFT_AUTH_CODE,

		-- Payment Address
		GIFT_PAYMENT_ADDRESS.IS_PRIMARY AS GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS.UNDELIVERABLE AS GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS.INACTIVE AS GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_1 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_2 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_3 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS.CITY AS GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS.STATE_PROVINCE AS GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS.POSTAL_CODE AS GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS.COUNTRY AS GIFT_PAYMENT_ADDRESS_COUNTRY,
			-- Payment Phone
		GIFT_PAYMENT_PHONE.NUMBER AS GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE.IS_PRIMARY AS GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE.UNDELIVERABLE AS GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE.INACTIVE AS GIFT_PAYMENT_PHONE_INACTIVE,

		-- Gift Distribution Line Information
		DISTRO_LINE.DISTRO_LINE_ID AS DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE.AMOUNT AS DISTRO_LINE_AMOUNT,
		DISTRO_LINE.PERCENTAGE AS DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE.PROJECT_CODE AS DISTRO_LINE_PROJECT_CODE,
		IFNULL(DISTRO_LINE.MOTIVATION_CODE, DISTRO_LINE.OTHER_MOTIVATION) AS DISTRO_LINE_MOTIVATION_CODE,

	    -- Associated Pledge Information
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_RECURRING AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_AMOUNT_PER_GIFT AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_AMOUNT_TOTAL AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_CURRENCY_CODE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_STATUS AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_FREQUENCY AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_PLEDGE_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_PROJECTED_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_START_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_END_DATE AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
	    VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMENTS AS VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
	    VW_PLEDGES_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,

	    -- Associated Recurring Gift Information
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID AS VW_RGD_COMMITMENT_COMMITMENT_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID AS VW_RGD_COMMITMENT_CONSTITUENT_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AUTO_PAY AS VW_RGD_COMMITMENT_AUTO_PAY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AMOUNT_PER_GIFT AS VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_AMOUNT_TOTAL AS VW_RGD_COMMITMENT_AMOUNT_TOTAL,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CURRENCY_CODE AS VW_RGD_COMMITMENT_CURRENCY_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_FREQUENCY AS VW_RGD_COMMITMENT_FREQUENCY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_START_DATE AS VW_RGD_COMMITMENT_START_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_END_DATE AS VW_RGD_COMMITMENT_END_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_STATUS AS VW_RGD_COMMITMENT_STATUS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMENTS AS VW_RGD_COMMITMENT_COMMENTS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CREATE_DATE AS VW_RGD_COMMITMENT_CREATE_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_UPDATE_DATE AS VW_RGD_COMMITMENT_UPDATE_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_TYPE AS VW_RGD_COMMITMENT_PAYMENT_TYPE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS AS VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CHECK_NUMBER AS VW_RGD_COMMITMENT_CHECK_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3 AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_CITY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_ADDRESS_COUNTRY AS VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_NUMBER AS VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_IS_PRIMARY AS VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE AS VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_PAYMENT_PHONE_INACTIVE AS VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_RGD_DISTRO_LINE_AMOUNT,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_RGD_DISTRO_LINE_PERCENTAGE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_RGD_DISTRO_LINE_PROJECT_CODE,
	    VW_RECURRINGGIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_RGD_DISTRO_LINE_MOTIVATION_CODE
	FROM GIFT
	LEFT JOIN PAYMENT_SOURCE ON GIFT.PAYMENT_SOURCE_ID = PAYMENT_SOURCE.PAYMENT_SOURCE_ID
	LEFT JOIN ADDRESS GIFT_PAYMENT_ADDRESS ON GIFT.ADDRESS_ID = GIFT_PAYMENT_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE GIFT_PAYMENT_PHONE ON GIFT.PHONE_ID = GIFT_PAYMENT_PHONE.PHONE_ID
	LEFT JOIN DISTRO_LINE ON GIFT.GIFT_ID = DISTRO_LINE.GIFT_ID
	LEFT JOIN CONSTITUENT ON CONSTITUENT.CONSTITUENT_ID = GIFT.CONSTITUENT_ID
	LEFT JOIN CUSTOM_FIELD CUSTOM_FIELD_ASSOCIATEDPLEDGE ON CUSTOM_FIELD_ASSOCIATEDPLEDGE.FIELD_NAME = 'associatedPledgeId'
		AND CUSTOM_FIELD_ASSOCIATEDPLEDGE.ENTITY_TYPE = 'distributionline'
		AND DISTRO_LINE.DISTRO_LINE_ID = CUSTOM_FIELD_ASSOCIATEDPLEDGE.ENTITY_ID
	LEFT JOIN VW_PLEDGES_DISTRIBUTIONS ON VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID = CUSTOM_FIELD_ASSOCIATEDPLEDGE.FIELD_VALUE
	LEFT JOIN CUSTOM_FIELD CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT ON CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.FIELD_NAME = 'associatedRecurringGiftId'
		AND CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.ENTITY_TYPE = 'distributionline'
		AND DISTRO_LINE.DISTRO_LINE_ID = CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.ENTITY_ID
	LEFT JOIN VW_RECURRINGGIFTS_DISTRIBUTIONS ON VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_COMMITMENT_ID = CUSTOM_FIELD_ASSOCIATEDRECURRINGGIFT.FIELD_VALUE
;



-- *********************************************************************************************************************
--
-- Gift Adjustments & Distributions in Kind View
--
-- *********************************************************************************************************************

DROP VIEW IF EXISTS VW_ADJUSTED_GIFTS_DISTRIBUTIONS;
CREATE VIEW VW_ADJUSTED_GIFTS_DISTRIBUTIONS
AS
	SELECT
		ADJUSTED_GIFT.ADJUSTED_GIFT_ID AS ADJUSTED_GIFT_ADJUSTED_GIFT_ID,
		(SELECT SUM(ADJUSTED_AMOUNT) FROM ADJUSTED_GIFT ADJUSTED_GIFT_TOTAL WHERE ADJUSTED_GIFT_TOTAL.GIFT_ID = ADJUSTED_GIFT.GIFT_ID) AS ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL,
		ADJUSTED_GIFT.ADJUSTED_AMOUNT AS ADJUSTED_GIFT_ADJUSTED_AMOUNT,
		ADJUSTED_GIFT.ADJUSTED_REASON AS ADJUSTED_GIFT_ADJUSTED_REASON,
		ADJUSTED_GIFT.ADJUSTED_STATUS AS ADJUSTED_GIFT_ADJUSTED_STATUS,
		ADJUSTED_GIFT.ADJUSTED_TRANSACTION_DATE AS ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE,
		ADJUSTED_GIFT.ADJUSTED_TYPE AS ADJUSTED_GIFT_ADJUSTED_TYPE,
		ADJUSTED_GIFT.ADJUSTED_PAYMENT_REQUIRED AS ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED,
		ADJUSTED_GIFT.ADJUSTED_PAYMENT_TO AS ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO,
		ADJUSTED_GIFT.COMMENTS AS ADJUSTED_GIFT_COMMENTS,
		ADJUSTED_GIFT.GIFT_ID AS ADJUSTED_GIFT_GIFT_ID,
		ADJUSTED_GIFT.PAYMENT_MESSAGE AS ADJUSTED_GIFT_PAYMENT_MESSAGE,
		ADJUSTED_GIFT.PAYMENT_STATUS AS ADJUSTED_GIFT_PAYMENT_STATUS,
		ADJUSTED_GIFT.PAYMENT_TXREFNUM AS ADJUSTED_GIFT_PAYMENT_TXREFNUM,
		ADJUSTED_GIFT.POSTED AS ADJUSTED_GIFT_POSTED,
		ADJUSTED_GIFT.POSTED_DATE AS ADJUSTED_GIFT_POSTED_DATE,
		ADJUSTED_GIFT.CONSTITUENT_ID AS ADJUSTED_GIFT_CONSTITUENT_ID,
		ADJUSTED_GIFT.ADDRESS_ID AS ADJUSTED_GIFT_ADDRESS_ID,
		ADJUSTED_GIFT.PHONE_ID AS ADJUSTED_GIFT_PHONE_ID,
		ADJUSTED_GIFT.PAYMENT_SOURCE_ID AS ADJUSTED_GIFT_PAYMENT_SOURCE_ID,
		ADJUSTED_GIFT.CREATE_DATE AS ADJUSTED_GIFT_CREATE_DATE,
		ADJUSTED_GIFT.UPDATE_DATE AS ADJUSTED_GIFT_UPDATE_DATE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_PROFILE AS ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE,
		ADJUSTED_GIFT.PAYMENT_TYPE AS ADJUSTED_GIFT_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		ADJUSTED_GIFT.CHECK_NUMBER AS ADJUSTED_GIFT_CHECK_NUMBER,
		ADJUSTED_GIFT.AUTH_CODE AS ADJUSTED_GIFT_AUTH_CODE,

		-- Payment Address
		ADJUSTED_GIFT_PAYMENT_ADDRESS.INACTIVE AS ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.IS_PRIMARY AS ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.UNDELIVERABLE AS ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_1 AS ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_2 AS ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.ADDRESS_LINE_3 AS ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.CITY AS ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.STATE_PROVINCE AS ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.POSTAL_CODE AS ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		ADJUSTED_GIFT_PAYMENT_ADDRESS.COUNTRY AS ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY,
		-- Payment Phone
		ADJUSTED_GIFT_PAYMENT_PHONE.NUMBER AS ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER,
		ADJUSTED_GIFT_PAYMENT_PHONE.IS_PRIMARY AS ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY,
		ADJUSTED_GIFT_PAYMENT_PHONE.UNDELIVERABLE AS ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		ADJUSTED_GIFT_PAYMENT_PHONE.INACTIVE AS ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE,

		DISTRO_LINE.DISTRO_LINE_ID AS DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE.AMOUNT AS DISTRO_LINE_AMOUNT,
		DISTRO_LINE.PERCENTAGE AS DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE.PROJECT_CODE AS DISTRO_LINE_PROJECT_CODE,
		IFNULL(DISTRO_LINE.MOTIVATION_CODE, DISTRO_LINE.OTHER_MOTIVATION) AS DISTRO_LINE_MOTIVATION_CODE
	FROM ADJUSTED_GIFT
	LEFT JOIN DISTRO_LINE ON DISTRO_LINE.ADJUSTED_GIFT_ID = ADJUSTED_GIFT.ADJUSTED_GIFT_ID
	LEFT JOIN PAYMENT_SOURCE ON ADJUSTED_GIFT.PAYMENT_SOURCE_ID = PAYMENT_SOURCE.PAYMENT_SOURCE_ID
	LEFT JOIN ADDRESS ADJUSTED_GIFT_PAYMENT_ADDRESS ON ADJUSTED_GIFT.ADDRESS_ID = ADJUSTED_GIFT_PAYMENT_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE ADJUSTED_GIFT_PAYMENT_PHONE ON ADJUSTED_GIFT.PHONE_ID = ADJUSTED_GIFT_PAYMENT_PHONE.PHONE_ID
;



-- *********************************************************************************************************************
--
-- Gifts in Kind View
--
-- *********************************************************************************************************************

DROP VIEW IF EXISTS VW_GIFTS_IN_KIND;
CREATE VIEW VW_GIFTS_IN_KIND
AS
	SELECT
		GIFT_IN_KIND.GIFT_IN_KIND_ID AS GIFT_IN_KIND_GIFT_IN_KIND_ID,
		GIFT_IN_KIND.FAIR_MARKET_VALUE AS GIFT_IN_KIND_FAIR_MARKET_VALUE,
		GIFT_IN_KIND.CURRENCY_CODE AS GIFT_IN_KIND_CURRENCY_CODE,
		GIFT_IN_KIND.DONATION_DATE AS GIFT_IN_KIND_DONATION_DATE,
		IFNULL(GIFT_IN_KIND.MOTIVATION_CODE, GIFT_IN_KIND.OTHER_MOTIVATION) AS GIFT_IN_KIND_MOTIVATION_CODE,
		GIFT_IN_KIND.ANONYMOUS AS GIFT_IN_KIND_ANONYMOUS,
		GIFT_IN_KIND.RECOGNITION_NAME AS GIFT_IN_KIND_RECOGNITION_NAME,
		GIFT_IN_KIND.TRANSACTION_DATE AS GIFT_IN_KIND_TRANSACTION_DATE,
		GIFT_IN_KIND.GIFT_ID AS GIFT_IN_KIND_GIFT_ID,
		GIFT_IN_KIND.CONSTITUENT_ID AS GIFT_IN_KIND_CONSTITUENT_ID,
		GIFT_IN_KIND.CREATE_DATE AS GIFT_IN_KIND_CREATE_DATE,
		GIFT_IN_KIND.UPDATE_DATE AS GIFT_IN_KIND_UPDATE_DATE
	FROM GIFT_IN_KIND
;



-- *********************************************************************************************************************
--
-- Gifts in Kind View
--
-- *********************************************************************************************************************

DROP VIEW IF EXISTS VW_GIFTS_IN_KIND_DETAILS;
CREATE VIEW VW_GIFTS_IN_KIND_DETAILS
AS
	SELECT
		GIFT_IN_KIND.GIFT_IN_KIND_ID AS GIFT_IN_KIND_GIFT_IN_KIND_ID,
		GIFT_IN_KIND.FAIR_MARKET_VALUE AS GIFT_IN_KIND_FAIR_MARKET_VALUE,
		GIFT_IN_KIND.CURRENCY_CODE AS GIFT_IN_KIND_CURRENCY_CODE,
		GIFT_IN_KIND.DONATION_DATE AS GIFT_IN_KIND_DONATION_DATE,
		IFNULL(GIFT_IN_KIND.MOTIVATION_CODE, GIFT_IN_KIND.OTHER_MOTIVATION) AS GIFT_IN_KIND_MOTIVATION_CODE,
		GIFT_IN_KIND.ANONYMOUS AS GIFT_IN_KIND_ANONYMOUS,
		GIFT_IN_KIND.RECOGNITION_NAME AS GIFT_IN_KIND_RECOGNITION_NAME,
		GIFT_IN_KIND.TRANSACTION_DATE AS GIFT_IN_KIND_TRANSACTION_DATE,
		GIFT_IN_KIND.GIFT_ID AS GIFT_IN_KIND_GIFT_ID,
		GIFT_IN_KIND.CONSTITUENT_ID AS GIFT_IN_KIND_CONSTITUENT_ID,
		GIFT_IN_KIND.CREATE_DATE AS GIFT_IN_KIND_CREATE_DATE,
		GIFT_IN_KIND.UPDATE_DATE AS GIFT_IN_KIND_UPDATE_DATE,

		-- Gift In Kind Details
		GIFT_IN_KIND_DETAIL.GIK_DETAIL_ID AS GIFT_IN_KIND_DETAIL_GIK_DETAIL_ID,
		GIFT_IN_KIND_DETAIL.FAIR_MARKET_VALUE AS GIFT_IN_KIND_DETAIL_FAIR_MARKET_VALUE,
		GIFT_IN_KIND_DETAIL.DESCRIPTION AS GIFT_IN_KIND_DETAIL_DESCRIPTION,
		GIFT_IN_KIND_DETAIL.PROJECT_CODE AS GIFT_IN_KIND_DETAIL_PROJECT_CODE,
		GIFT_IN_KIND_DETAIL.TAX_DEDUCTIBLE AS GIFT_IN_KIND_DETAIL_TAX_DEDUCTIBLE,
		GIFT_IN_KIND_DETAIL.FMV_METHOD AS GIFT_IN_KIND_DETAIL_FMV_METHOD,
		GIFT_IN_KIND_DETAIL.CATEGORY AS GIFT_IN_KIND_DETAIL_CATEGORY,
		GIFT_IN_KIND_DETAIL.QUANTITY AS GIFT_IN_KIND_DETAIL_QUANTITY
	FROM GIFT_IN_KIND
	JOIN GIFT_IN_KIND_DETAIL ON GIFT_IN_KIND_DETAIL.GIFT_IN_KIND_ID = GIFT_IN_KIND.GIFT_IN_KIND_ID
;

-- *********************************************************************************************************************
--
-- Payment History View & Field Definitions
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_PAYMENTHISTORY;
CREATE VIEW VW_PAYMENTHISTORY
AS
	SELECT
		PAYMENT_HISTORY.PAYMENT_HISTORY_ID AS PAYMENT_HISTORY_PAYMENT_HISTORY_ID,
		PAYMENT_HISTORY.CONSTITUENT_ID AS PAYMENT_HISTORY_CONSTITUENT_ID,
		PAYMENT_HISTORY.GIFT_ID AS PAYMENT_HISTORY_GIFT_ID,
		PAYMENT_HISTORY.TRANSACTION_DATE AS PAYMENT_HISTORY_TRANSACTION_DATE,
		PAYMENT_HISTORY.PAYMENT_TYPE AS PAYMENT_HISTORY_PAYMENT_TYPE,
		PAYMENT_HISTORY.AMOUNT AS PAYMENT_HISTORY_AMOUNT,
		PAYMENT_HISTORY.CURRENCY_CODE AS PAYMENT_HISTORY_CURRENCY_CODE,
		PAYMENT_HISTORY.PAYMENT_DESC AS PAYMENT_HISTORY_PAYMENT_DESC,
		CASE PAYMENT_HISTORY.PAYMENT_HISTORY_TYPE WHEN 0 THEN 'Unspecified' WHEN 1 THEN 'Gift' WHEN 2 THEN 'Membership' WHEN 3 THEN 'Order' END AS PAYMENT_HISTORY_PAYMENT_HISTORY_TYPE
	FROM PAYMENT_HISTORY
;


-- *********************************************************************************************************************
--
-- Payment Methods View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_PAYMENTMETHODS;
CREATE VIEW VW_PAYMENTMETHODS
AS
	SELECT
		PAYMENT_SOURCE.PAYMENT_SOURCE_ID AS PAYMENT_SOURCE_PAYMENT_SOURCE_ID,
		PAYMENT_SOURCE.CONSTITUENT_ID AS PAYMENT_SOURCE_CONSTITUENT_ID,
		PAYMENT_SOURCE.PAYMENT_PROFILE AS PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS PAYMENT_SOURCE_INACTIVE,
		PAYMENT_SOURCE.PAYMENT_TYPE AS PAYMENT_SOURCE_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		-- Payment Address
		PAYMENTMETHOD_ADDRESS.IS_PRIMARY AS PAYMENT_SOURCE_ADDRESS_IS_PRIMARY,
		PAYMENTMETHOD_ADDRESS.UNDELIVERABLE AS PAYMENT_SOURCE_ADDRESS_UNDELIVERABLE,
		PAYMENTMETHOD_ADDRESS.INACTIVE AS PAYMENT_SOURCE_ADDRESS_INACTIVE,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_1 AS PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_1,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_2 AS PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_2,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_3 AS PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_3,
		PAYMENTMETHOD_ADDRESS.CITY AS PAYMENT_SOURCE_ADDRESS_CITY,
		PAYMENTMETHOD_ADDRESS.STATE_PROVINCE AS PAYMENT_SOURCE_ADDRESS_STATE_PROVINCE,
		PAYMENTMETHOD_ADDRESS.POSTAL_CODE AS PAYMENT_SOURCE_ADDRESS_POSTAL_CODE,
		PAYMENTMETHOD_ADDRESS.COUNTRY AS PAYMENT_SOURCE_ADDRESS_COUNTRY,
			-- Payment Phone
		PAYMENTMETHOD_PHONE.NUMBER AS PAYMENT_SOURCE_PHONE_NUMBER,
		PAYMENTMETHOD_PHONE.IS_PRIMARY AS PAYMENT_SOURCE_PHONE_IS_PRIMARY,
		PAYMENTMETHOD_PHONE.UNDELIVERABLE AS PAYMENT_SOURCE_PHONE_UNDELIVERABLE,
		PAYMENTMETHOD_PHONE.INACTIVE AS PAYMENT_SOURCE_PHONE_INACTIVE
	FROM PAYMENT_SOURCE
	LEFT JOIN ADDRESS PAYMENTMETHOD_ADDRESS ON PAYMENT_SOURCE.ADDRESS_ID = PAYMENTMETHOD_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE PAYMENTMETHOD_PHONE ON PAYMENT_SOURCE.PHONE_ID = PAYMENTMETHOD_PHONE.PHONE_ID
;


-- *********************************************************************************************************************
--
-- Pledges View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_PLEDGES;
CREATE VIEW VW_PLEDGES
AS
	SELECT
		COMMITMENT.CONSTITUENT_ID AS COMMITMENT_CONSTITUENT_ID,
		COMMITMENT.PLEDGE_ID AS COMMITMENT_COMMITMENT_ID,
		COMMITMENT.RECURRING AS COMMITMENT_RECURRING,
		COMMITMENT.AMOUNT_PER_GIFT AS COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT.AMOUNT_TOTAL AS COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT.CURRENCY_CODE AS COMMITMENT_CURRENCY_CODE,
		COMMITMENT.PLEDGE_STATUS AS COMMITMENT_STATUS,
		COMMITMENT.FREQUENCY AS COMMITMENT_FREQUENCY,
		COMMITMENT.PLEDGE_DATE AS COMMITMENT_PLEDGE_DATE,
		COMMITMENT.PROJECTED_DATE AS COMMITMENT_PROJECTED_DATE,
		COMMITMENT.START_DATE AS COMMITMENT_START_DATE,
		COMMITMENT.END_DATE AS COMMITMENT_END_DATE,
		COMMITMENT.COMMENTS AS COMMITMENT_COMMENTS
	FROM PLEDGE AS COMMITMENT
;



-- *********************************************************************************************************************
--
-- Constituents & Gifts View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_GIFTS;
CREATE VIEW VW_CONSTITUENTS_GIFTS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Gift Information
		GIFT_CONSTITUENT_ID,
		GIFT_GIFT_ID,
		GIFT_AMOUNT,
		GIFT_CURRENCY_CODE,
		GIFT_DONATION_DATE,
		GIFT_POSTMARK_DATE,
		GIFT_COMMENTS,
		GIFT_TRANSACTIONDATE,
		GIFT_GIFT_STATUS,
		GIFT_GIFT_TYPE,
		GIFT_AVS_MESSAGE,
		GIFT_DEDUCTIBLE_AMOUNT,
		GIFT_ENTRY_TYPE,
		GIFT_ORIGINAL_GIFT_ID,
		GIFT_PAYMENT_MESSAGE,
		GIFT_PAYMENT_STATUS,
		GIFT_POSTED,
		GIFT_POSTED_DATE,
		GIFT_PAYMENT_TXREFNUM,
		GIFT_ADDRESS_ID,
		GIFT_PAYMENT_SOURCE_ID,
		GIFT_PHONE_ID,
		GIFT_CREATE_DATE,
		GIFT_UPDATE_DATE,
		GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT_PAYMENT_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT_CHECK_NUMBER,
		GIFT_AUTH_CODE,
		GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS_COUNTRY,
		GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE_INACTIVE,

		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,
		VW_RGD_COMMITMENT_COMMITMENT_ID,
		VW_RGD_COMMITMENT_CONSTITUENT_ID,
		VW_RGD_COMMITMENT_AUTO_PAY,
		VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
		VW_RGD_COMMITMENT_AMOUNT_TOTAL,
		VW_RGD_COMMITMENT_CURRENCY_CODE,
		VW_RGD_COMMITMENT_FREQUENCY,
		VW_RGD_COMMITMENT_START_DATE,
		VW_RGD_COMMITMENT_END_DATE,
		VW_RGD_COMMITMENT_STATUS,
		VW_RGD_COMMITMENT_COMMENTS,
		VW_RGD_COMMITMENT_CREATE_DATE,
		VW_RGD_COMMITMENT_UPDATE_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_RGD_COMMITMENT_CHECK_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
		VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_RGD_DISTRO_LINE_AMOUNT,
		VW_RGD_DISTRO_LINE_PERCENTAGE,
		VW_RGD_DISTRO_LINE_PROJECT_CODE,
		VW_RGD_DISTRO_LINE_MOTIVATION_CODE,

		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_REASON AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_REASON,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_STATUS AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TYPE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_COMMENTS AS VW_AGD_ADJUSTED_GIFT_COMMENTS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_MESSAGE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_MESSAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_STATUS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TXREFNUM AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TXREFNUM,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED AS VW_AGD_ADJUSTED_GIFT_POSTED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED_DATE AS VW_AGD_ADJUSTED_GIFT_POSTED_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CONSTITUENT_ID AS VW_AGD_ADJUSTED_GIFT_CONSTITUENT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADDRESS_ID AS VW_AGD_ADJUSTED_GIFT_ADDRESS_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PHONE_ID AS VW_AGD_ADJUSTED_GIFT_PHONE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ID AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CREATE_DATE AS VW_AGD_ADJUSTED_GIFT_CREATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_UPDATE_DATE AS VW_AGD_ADJUSTED_GIFT_UPDATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CHECK_NUMBER AS VW_AGD_ADJUSTED_GIFT_CHECK_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_AUTH_CODE AS VW_AGD_ADJUSTED_GIFT_AUTH_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_AGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_AGD_DISTRO_LINE_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_AGD_DISTRO_LINE_PERCENTAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_AGD_DISTRO_LINE_PROJECT_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_AGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_GIFTS ON CONSTITUENT_CONSTITUENT_ID = GIFT_CONSTITUENT_ID
	LEFT JOIN VW_ADJUSTED_GIFTS_DISTRIBUTIONS ON VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_GIFT_ID = VW_GIFTS.GIFT_GIFT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Gift Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_GIFTDISTRIBUTIONS;
CREATE VIEW VW_CONSTITUENTS_GIFTDISTRIBUTIONS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Gift Information
		GIFT_GIFT_ID,
		GIFT_AMOUNT,
		GIFT_CURRENCY_CODE,
		GIFT_DONATION_DATE,
		GIFT_POSTMARK_DATE,
		GIFT_COMMENTS,
		GIFT_TRANSACTIONDATE,
		GIFT_GIFT_STATUS,
		GIFT_GIFT_TYPE,
		GIFT_AVS_MESSAGE,
		GIFT_DEDUCTIBLE_AMOUNT,
		GIFT_ENTRY_TYPE,
		GIFT_ORIGINAL_GIFT_ID,
		GIFT_PAYMENT_MESSAGE,
		GIFT_PAYMENT_STATUS,
		GIFT_POSTED,
		GIFT_POSTED_DATE,
		GIFT_PAYMENT_TXREFNUM,
		GIFT_ADDRESS_ID,
		GIFT_PAYMENT_SOURCE_ID,
		GIFT_PHONE_ID,
		GIFT_CREATE_DATE,
		GIFT_UPDATE_DATE,
		GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT_PAYMENT_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT_CHECK_NUMBER,
		GIFT_AUTH_CODE,
		GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS_COUNTRY,
		GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE_INACTIVE,
		VW_GIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID,
		VW_GIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT,
		VW_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE,
		VW_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE,
		VW_GIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE,

		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,
		VW_RGD_COMMITMENT_COMMITMENT_ID,
		VW_RGD_COMMITMENT_CONSTITUENT_ID,
		VW_RGD_COMMITMENT_AUTO_PAY,
		VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
		VW_RGD_COMMITMENT_AMOUNT_TOTAL,
		VW_RGD_COMMITMENT_CURRENCY_CODE,
		VW_RGD_COMMITMENT_FREQUENCY,
		VW_RGD_COMMITMENT_START_DATE,
		VW_RGD_COMMITMENT_END_DATE,
		VW_RGD_COMMITMENT_STATUS,
		VW_RGD_COMMITMENT_COMMENTS,
		VW_RGD_COMMITMENT_CREATE_DATE,
		VW_RGD_COMMITMENT_UPDATE_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_RGD_COMMITMENT_CHECK_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
		VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_RGD_DISTRO_LINE_AMOUNT,
		VW_RGD_DISTRO_LINE_PERCENTAGE,
		VW_RGD_DISTRO_LINE_PROJECT_CODE,
		VW_RGD_DISTRO_LINE_MOTIVATION_CODE,

		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_REASON AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_REASON,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_STATUS AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TYPE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_COMMENTS AS VW_AGD_ADJUSTED_GIFT_COMMENTS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_MESSAGE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_MESSAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_STATUS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TXREFNUM AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TXREFNUM,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED AS VW_AGD_ADJUSTED_GIFT_POSTED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED_DATE AS VW_AGD_ADJUSTED_GIFT_POSTED_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CONSTITUENT_ID AS VW_AGD_ADJUSTED_GIFT_CONSTITUENT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADDRESS_ID AS VW_AGD_ADJUSTED_GIFT_ADDRESS_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PHONE_ID AS VW_AGD_ADJUSTED_GIFT_PHONE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ID AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CREATE_DATE AS VW_AGD_ADJUSTED_GIFT_CREATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_UPDATE_DATE AS VW_AGD_ADJUSTED_GIFT_UPDATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CHECK_NUMBER AS VW_AGD_ADJUSTED_GIFT_CHECK_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_AUTH_CODE AS VW_AGD_ADJUSTED_GIFT_AUTH_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_AGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_AGD_DISTRO_LINE_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_AGD_DISTRO_LINE_PERCENTAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_AGD_DISTRO_LINE_PROJECT_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_AGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_GIFTS_DISTRIBUTIONS ON CONSTITUENT_CONSTITUENT_ID = GIFT_CONSTITUENT_ID
	LEFT JOIN VW_ADJUSTED_GIFTS_DISTRIBUTIONS ON VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_GIFT_ID = VW_GIFTS_DISTRIBUTIONS.GIFT_GIFT_ID
;



-- *********************************************************************************************************************
--
-- Constituents, Gift Adjustments & Distributions View
--
-- *********************************************************************************************************************

DROP VIEW IF EXISTS VW_CONSTITUENTS_ADJUSTED_GIFTS_DISTRIBUTIONS;
CREATE VIEW VW_CONSTITUENTS_ADJUSTED_GIFTS_DISTRIBUTIONS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT_TOTAL,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_AMOUNT AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_REASON AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_REASON,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_STATUS AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TRANSACTION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_TYPE AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_REQUIRED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO AS VW_AGD_ADJUSTED_GIFT_ADJUSTED_PAYMENT_TO,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_COMMENTS AS VW_AGD_ADJUSTED_GIFT_COMMENTS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_GIFT_ID AS VW_AGD_ADJUSTED_GIFT_GIFT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_MESSAGE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_MESSAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_STATUS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_STATUS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TXREFNUM AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TXREFNUM,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED AS VW_AGD_ADJUSTED_GIFT_POSTED,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_POSTED_DATE AS VW_AGD_ADJUSTED_GIFT_POSTED_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CONSTITUENT_ID AS VW_AGD_ADJUSTED_GIFT_CONSTITUENT_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_ADDRESS_ID AS VW_AGD_ADJUSTED_GIFT_ADDRESS_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PHONE_ID AS VW_AGD_ADJUSTED_GIFT_PHONE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ID AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CREATE_DATE AS VW_AGD_ADJUSTED_GIFT_CREATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_UPDATE_DATE AS VW_AGD_ADJUSTED_GIFT_UPDATE_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS AS VW_AGD_ADJUSTED_GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CHECK_NUMBER AS VW_AGD_ADJUSTED_GIFT_CHECK_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_AUTH_CODE AS VW_AGD_ADJUSTED_GIFT_AUTH_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3 AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_CITY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_ADDRESS_COUNTRY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_NUMBER,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_IS_PRIMARY,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE AS VW_AGD_ADJUSTED_GIFT_PAYMENT_PHONE_INACTIVE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_DISTRO_LINE_ID AS VW_AGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_AMOUNT AS VW_AGD_DISTRO_LINE_AMOUNT,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PERCENTAGE AS VW_AGD_DISTRO_LINE_PERCENTAGE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_PROJECT_CODE AS VW_AGD_DISTRO_LINE_PROJECT_CODE,
		VW_ADJUSTED_GIFTS_DISTRIBUTIONS.DISTRO_LINE_MOTIVATION_CODE AS VW_AGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_ADJUSTED_GIFTS_DISTRIBUTIONS ON VW_ADJUSTED_GIFTS_DISTRIBUTIONS.ADJUSTED_GIFT_CONSTITUENT_ID = VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Gifts In Kind View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_GIFTS_IN_KIND;
CREATE VIEW VW_CONSTITUENTS_GIFTS_IN_KIND
AS
	SELECT
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID,
		VW_CONSTITUENTS.CONSTITUENT_ACCOUNT_NUMBER,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ROLE,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_CREATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_FIRST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_DONOR_PROFILE,
		VW_CONSTITUENTS.CONSTITUENT_LAST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LEGAL_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LOGIN_ID,
		VW_CONSTITUENTS.CONSTITUENT_MARITAL_STATUS,
		VW_CONSTITUENTS.CONSTITUENT_MIDDLE_NAME,
		VW_CONSTITUENTS.CONSTITUENT_NAICS_CODE,
		VW_CONSTITUENTS.CONSTITUENT_ORGANIZATION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_PREFERRED_PHONE_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_RECOGNITION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_SUFFIX,
		VW_CONSTITUENTS.CONSTITUENT_TITLE,
		VW_CONSTITUENTS.CONSTITUENT_UPDATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_SITE_NAME,

				-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		VW_GIFTS_IN_KIND.GIFT_IN_KIND_GIFT_IN_KIND_ID,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_FAIR_MARKET_VALUE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_CURRENCY_CODE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_DONATION_DATE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_MOTIVATION_CODE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_ANONYMOUS,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_RECOGNITION_NAME,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_TRANSACTION_DATE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_GIFT_ID,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_CONSTITUENT_ID,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_CREATE_DATE,
		VW_GIFTS_IN_KIND.GIFT_IN_KIND_UPDATE_DATE
	FROM VW_CONSTITUENTS
	JOIN VW_GIFTS_IN_KIND ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_GIFTS_IN_KIND.GIFT_IN_KIND_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Gifts In Kind Details View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_GIFTS_IN_KIND_DETAILS;
CREATE VIEW VW_CONSTITUENTS_GIFTS_IN_KIND_DETAILS
AS
	SELECT
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID,
		VW_CONSTITUENTS.CONSTITUENT_ACCOUNT_NUMBER,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ROLE,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_CREATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_FIRST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_DONOR_PROFILE,
		VW_CONSTITUENTS.CONSTITUENT_LAST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LEGAL_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LOGIN_ID,
		VW_CONSTITUENTS.CONSTITUENT_MARITAL_STATUS,
		VW_CONSTITUENTS.CONSTITUENT_MIDDLE_NAME,
		VW_CONSTITUENTS.CONSTITUENT_NAICS_CODE,
		VW_CONSTITUENTS.CONSTITUENT_ORGANIZATION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_PREFERRED_PHONE_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_RECOGNITION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_SUFFIX,
		VW_CONSTITUENTS.CONSTITUENT_TITLE,
		VW_CONSTITUENTS.CONSTITUENT_UPDATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_GIFT_IN_KIND_ID,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_FAIR_MARKET_VALUE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_CURRENCY_CODE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DONATION_DATE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_MOTIVATION_CODE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_ANONYMOUS,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_RECOGNITION_NAME,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_TRANSACTION_DATE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_GIFT_ID,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_CONSTITUENT_ID,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_CREATE_DATE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_UPDATE_DATE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_GIK_DETAIL_ID,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_FAIR_MARKET_VALUE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_DESCRIPTION,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_PROJECT_CODE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_TAX_DEDUCTIBLE,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_FMV_METHOD,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_CATEGORY,
		VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_DETAIL_QUANTITY
	FROM VW_CONSTITUENTS
	JOIN VW_GIFTS_IN_KIND_DETAILS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_GIFTS_IN_KIND_DETAILS.GIFT_IN_KIND_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Payment History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PAYMENTHISTORY;
CREATE VIEW VW_CONSTITUENTS_PAYMENTHISTORY
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		PAYMENT_HISTORY_PAYMENT_HISTORY_ID,
		PAYMENT_HISTORY_CONSTITUENT_ID,
		PAYMENT_HISTORY_GIFT_ID,
		PAYMENT_HISTORY_TRANSACTION_DATE,
		PAYMENT_HISTORY_PAYMENT_TYPE,
		PAYMENT_HISTORY_AMOUNT,
		PAYMENT_HISTORY_CURRENCY_CODE,
		PAYMENT_HISTORY_PAYMENT_DESC,
		PAYMENT_HISTORY_PAYMENT_HISTORY_TYPE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_PAYMENTHISTORY ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_PAYMENTHISTORY.PAYMENT_HISTORY_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Payment Methods View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PAYMENTMETHODS;
CREATE VIEW VW_CONSTITUENTS_PAYMENTMETHODS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Payment Information
		PAYMENT_SOURCE.PAYMENT_SOURCE_ID AS PAYMENT_SOURCE_PAYMENT_SOURCE_ID,
		PAYMENT_SOURCE.CONSTITUENT_ID AS PAYMENT_SOURCE_CONSTITUENT_ID,
		PAYMENT_SOURCE.PAYMENT_PROFILE AS GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE.INACTIVE AS GIFT_PAYMENT_SOURCE_INACTIVE,
		PAYMENT_SOURCE.PAYMENT_TYPE AS GIFT_PAYMENT_SOURCE_PAYMENT_TYPE,
		PAYMENT_SOURCE.CREDIT_CARD_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		PAYMENT_SOURCE.CREDIT_CARD_TYPE AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		CONCAT(MONTH(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION), '/', YEAR(PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION)) AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE.CREDIT_CARD_EXPIRATION AS GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE.ACH_HOLDER_NAME AS GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		CONCAT('****', RIGHT(PAYMENT_SOURCE.ACH_ROUTING_NUMBER, 4)) AS GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE.LAST_FOUR_DIGITS AS GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		-- Payment Address
		PAYMENTMETHOD_ADDRESS.IS_PRIMARY AS GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		PAYMENTMETHOD_ADDRESS.UNDELIVERABLE AS GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_1 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_2 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		PAYMENTMETHOD_ADDRESS.ADDRESS_LINE_3 AS GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		PAYMENTMETHOD_ADDRESS.CITY AS GIFT_PAYMENT_ADDRESS_CITY,
		PAYMENTMETHOD_ADDRESS.STATE_PROVINCE AS GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		PAYMENTMETHOD_ADDRESS.POSTAL_CODE AS GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		PAYMENTMETHOD_ADDRESS.COUNTRY AS GIFT_PAYMENT_ADDRESS_COUNTRY,
			-- Payment Phone
		PAYMENTMETHOD_PHONE.NUMBER AS GIFT_PAYMENT_PHONE_NUMBER
	FROM VW_CONSTITUENTS
	LEFT JOIN PAYMENT_SOURCE ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = PAYMENT_SOURCE.CONSTITUENT_ID
	LEFT JOIN ADDRESS PAYMENTMETHOD_ADDRESS ON PAYMENT_SOURCE.ADDRESS_ID = PAYMENTMETHOD_ADDRESS.ADDRESS_ID
	LEFT JOIN PHONE PAYMENTMETHOD_PHONE ON PAYMENT_SOURCE.PHONE_ID = PAYMENTMETHOD_PHONE.PHONE_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Pledges View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PLEDGES;
CREATE VIEW VW_CONSTITUENTS_PLEDGES
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_RECURRING,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_STATUS,
		COMMITMENT_FREQUENCY,
		COMMITMENT_PLEDGE_DATE,
		COMMITMENT_PROJECTED_DATE,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_COMMENTS
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_PLEDGES ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_PLEDGES.COMMITMENT_CONSTITUENT_ID
;



-- *********************************************************************************************************************
--
-- Constituents & Pledges & Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_PLEDGES_DISTRIBUTIONS;
CREATE VIEW VW_CONSTITUENTS_PLEDGES_DISTRIBUTIONS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_RECURRING,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_STATUS,
		COMMITMENT_FREQUENCY,
		COMMITMENT_PLEDGE_DATE,
		COMMITMENT_PROJECTED_DATE,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_COMMENTS
		DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE_AMOUNT,
		DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE_PROJECT_CODE,
		DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_PLEDGES_DISTRIBUTIONS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_PLEDGES_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Recurring Gifts View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RECURRINGGIFTS;
CREATE VIEW VW_CONSTITUENTS_RECURRINGGIFTS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_AUTO_PAY,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_FREQUENCY,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_STATUS,
		COMMITMENT_COMMENTS,
		COMMITMENT_CREATE_DATE,
		COMMITMENT_UPDATE_DATE,
		COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		COMMITMENT_PAYMENT_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		COMMITMENT_CHECK_NUMBER,
		COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		COMMITMENT_PAYMENT_ADDRESS_CITY,
		COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		COMMITMENT_PAYMENT_PHONE_NUMBER,
		COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		COMMITMENT_PAYMENT_PHONE_INACTIVE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_RECURRINGGIFTS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_RECURRINGGIFTS.COMMITMENT_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituents & Recurring Gifts & Distributions View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RECURRINGGIFTS_DISTRIBUTIONS;
CREATE VIEW VW_CONSTITUENTS_RECURRINGGIFTS_DISTRIBUTIONS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_AUTO_PAY,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_FREQUENCY,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_STATUS,
		COMMITMENT_COMMENTS,
		COMMITMENT_CREATE_DATE,
		COMMITMENT_UPDATE_DATE,
		COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		COMMITMENT_PAYMENT_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		COMMITMENT_CHECK_NUMBER,
		COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		COMMITMENT_PAYMENT_ADDRESS_CITY,
		COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		COMMITMENT_PAYMENT_PHONE_NUMBER,
		COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		COMMITMENT_PAYMENT_PHONE_INACTIVE,
		DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE_AMOUNT,
		DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE_PROJECT_CODE,
		DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS
	LEFT JOIN VW_RECURRINGGIFTS_DISTRIBUTIONS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_RECURRINGGIFTS_DISTRIBUTIONS.COMMITMENT_CONSTITUENT_ID
;



-- *********************************************************************************************************************
--
-- Constituent, Relationships & Gifts View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RELATIONSHIPS_GIFTS;
CREATE VIEW VW_CONSTITUENTS_RELATIONSHIPS_GIFTS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,
		CONSTITUENT_EMPLOYER,
		CONSTITUENT_EMPLOYER_CUSTOM_FIELD_NAME,
		CONSTITUENT_EMPLOYER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_HOUSEHOLD_MEMBER,
		CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_NAME,
		CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PARENT,
		CONSTITUENT_PARENT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PARENT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_CHILD,
		CONSTITUENT_CHILD_CUSTOM_FIELD_NAME,
		CONSTITUENT_CHILD_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SIBLING,
		CONSTITUENT_SIBLING_CUSTOM_FIELD_NAME,
		CONSTITUENT_SIBLING_CUSTOM_FIELD_VALUE,

		CONSTITUENT_FRIEND,
		CONSTITUENT_FRIEND_CUSTOM_FIELD_NAME,
		CONSTITUENT_FRIEND_CUSTOM_FIELD_VALUE,

		CONSTITUENT_EMPLOYEE,
		CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_NAME,
		CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SUBSIDIARY,
		CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_NAME,
		CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PRIMARYCONTACT,
		CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_BILLINGCONTACT,
		CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SALESCONTACT,
		CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PUBLICRELATIONSCONTACT,
		CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_VALUE,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Gift Information
		GIFT_CONSTITUENT_ID,
		GIFT_GIFT_ID,
		GIFT_AMOUNT,
		GIFT_CURRENCY_CODE,
		GIFT_DONATION_DATE,
		GIFT_POSTMARK_DATE,
		GIFT_COMMENTS,
		GIFT_TRANSACTIONDATE,
		GIFT_GIFT_STATUS,
		GIFT_GIFT_TYPE,
		GIFT_AVS_MESSAGE,
		GIFT_DEDUCTIBLE_AMOUNT,
		GIFT_ENTRY_TYPE,
		GIFT_ORIGINAL_GIFT_ID,
		GIFT_PAYMENT_MESSAGE,
		GIFT_PAYMENT_STATUS,
		GIFT_POSTED,
		GIFT_POSTED_DATE,
		GIFT_PAYMENT_TXREFNUM,
		GIFT_ADDRESS_ID,
		GIFT_PAYMENT_SOURCE_ID,
		GIFT_PHONE_ID,
		GIFT_CREATE_DATE,
		GIFT_UPDATE_DATE,
		GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT_PAYMENT_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT_CHECK_NUMBER,
		GIFT_AUTH_CODE,
		GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS_COUNTRY,
		GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE_INACTIVE,

		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,
		VW_RGD_COMMITMENT_COMMITMENT_ID,
		VW_RGD_COMMITMENT_CONSTITUENT_ID,
		VW_RGD_COMMITMENT_AUTO_PAY,
		VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
		VW_RGD_COMMITMENT_AMOUNT_TOTAL,
		VW_RGD_COMMITMENT_CURRENCY_CODE,
		VW_RGD_COMMITMENT_FREQUENCY,
		VW_RGD_COMMITMENT_START_DATE,
		VW_RGD_COMMITMENT_END_DATE,
		VW_RGD_COMMITMENT_STATUS,
		VW_RGD_COMMITMENT_COMMENTS,
		VW_RGD_COMMITMENT_CREATE_DATE,
		VW_RGD_COMMITMENT_UPDATE_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_RGD_COMMITMENT_CHECK_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
		VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_RGD_DISTRO_LINE_AMOUNT,
		VW_RGD_DISTRO_LINE_PERCENTAGE,
		VW_RGD_DISTRO_LINE_PROJECT_CODE,
		VW_RGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS_RELATIONSHIPS
	LEFT JOIN VW_GIFTS ON CONSTITUENT_CONSTITUENT_ID = GIFT_CONSTITUENT_ID
;


-- *********************************************************************************************************************
--
-- Constituent, Relationships, Gifts & Gift Distributions
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_CONSTITUENTS_RELATIONSHIPS_GIFTDISTRIBUTIONS;
CREATE VIEW VW_CONSTITUENTS_RELATIONSHIPS_GIFTDISTRIBUTIONS
AS
	SELECT
		CONSTITUENT_CONSTITUENT_ID,
		CONSTITUENT_ACCOUNT_NUMBER,
 		CONSTITUENT_CONSTITUENT_ROLE,
		CONSTITUENT_CONSTITUENT_TYPE,
		CONSTITUENT_CREATE_DATE,
		CONSTITUENT_FIRST_NAME,
 		CONSTITUENT_DONOR_PROFILE,
		CONSTITUENT_LAST_NAME,
		CONSTITUENT_LEGAL_NAME,
		CONSTITUENT_LOGIN_ID,
		CONSTITUENT_MARITAL_STATUS,
		CONSTITUENT_MIDDLE_NAME,
		CONSTITUENT_NAICS_CODE,
		CONSTITUENT_ORGANIZATION_NAME,
		CONSTITUENT_PREFERRED_PHONE_TYPE,
		CONSTITUENT_RECOGNITION_NAME,
		CONSTITUENT_SUFFIX,
		CONSTITUENT_TITLE,
		CONSTITUENT_UPDATE_DATE,
		CONSTITUENT_SITE_NAME,
		CONSTITUENT_EMPLOYER,
		CONSTITUENT_EMPLOYER_CUSTOM_FIELD_NAME,
		CONSTITUENT_EMPLOYER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_HOUSEHOLD_MEMBER,
		CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_NAME,
		CONSTITUENT_HOUSEHOLD_MEMBER_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PARENT,
		CONSTITUENT_PARENT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PARENT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_CHILD,
		CONSTITUENT_CHILD_CUSTOM_FIELD_NAME,
		CONSTITUENT_CHILD_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SIBLING,
		CONSTITUENT_SIBLING_CUSTOM_FIELD_NAME,
		CONSTITUENT_SIBLING_CUSTOM_FIELD_VALUE,

		CONSTITUENT_FRIEND,
		CONSTITUENT_FRIEND_CUSTOM_FIELD_NAME,
		CONSTITUENT_FRIEND_CUSTOM_FIELD_VALUE,

		CONSTITUENT_EMPLOYEE,
		CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_NAME,
		CONSTITUENT_EMPLOYEE_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SUBSIDIARY,
		CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_NAME,
		CONSTITUENT_SUBSIDIARY_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PRIMARYCONTACT,
		CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PRIMARYCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_BILLINGCONTACT,
		CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_BILLINGCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_SALESCONTACT,
		CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_SALESCONTACT_CUSTOM_FIELD_VALUE,

		CONSTITUENT_PUBLICRELATIONSCONTACT,
		CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_NAME,
		CONSTITUENT_PUBLICRELATIONSCONTACT_CUSTOM_FIELD_VALUE,

		-- Current Address
		ADDRESS_CURRENT_ADDRESS_ID,
		ADDRESS_CURRENT_ADDRESS_TYPE,
		ADDRESS_CURRENT_ACTIVATION_STATUS,
		ADDRESS_CURRENT_EFFECTIVE_DATE,
		ADDRESS_CURRENT_ADDRESS_LINE_1,
		ADDRESS_CURRENT_ADDRESS_LINE_2,
		ADDRESS_CURRENT_ADDRESS_LINE_3,
		ADDRESS_CURRENT_CITY,
		ADDRESS_CURRENT_STATE_PROVINCE,
		ADDRESS_CURRENT_COUNTRY,
		ADDRESS_CURRENT_POSTAL_CODE,
		ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		ADDRESS_CURRENT_COMMENT,
		ADDRESS_CURRENT_SEASONAL_END_DATE,
		ADDRESS_CURRENT_SEASONAL_START_DATE,
		ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		ADDRESS_CURRENT_TEMPORARY_END_DATE,
		ADDRESS_CURRENT_TEMPORARY_START_DATE,
		ADDRESS_CURRENT_CREATE_DATE,
		ADDRESS_CURRENT_UPDATE_DATE,
		ADDRESS_CURRENT_INACTIVE,
		ADDRESS_CURRENT_IS_PRIMARY,
		ADDRESS_CURRENT_UNDELIVERABLE,

		-- Gift Information
		GIFT_GIFT_ID,
		GIFT_AMOUNT,
		GIFT_CURRENCY_CODE,
		GIFT_DONATION_DATE,
		GIFT_POSTMARK_DATE,
		GIFT_COMMENTS,
		GIFT_TRANSACTIONDATE,
		GIFT_GIFT_STATUS,
		GIFT_GIFT_TYPE,
		GIFT_AVS_MESSAGE,
		GIFT_DEDUCTIBLE_AMOUNT,
		GIFT_ENTRY_TYPE,
		GIFT_ORIGINAL_GIFT_ID,
		GIFT_PAYMENT_MESSAGE,
		GIFT_PAYMENT_STATUS,
		GIFT_POSTED,
		GIFT_POSTED_DATE,
		GIFT_PAYMENT_TXREFNUM,
		GIFT_ADDRESS_ID,
		GIFT_PAYMENT_SOURCE_ID,
		GIFT_PHONE_ID,
		GIFT_CREATE_DATE,
		GIFT_UPDATE_DATE,
		GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT_PAYMENT_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT_CHECK_NUMBER,
		GIFT_AUTH_CODE,
		GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS_INACTIVE,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS_COUNTRY,
		GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE_INACTIVE,
		DISTRO_LINE_DISTRO_LINE_ID,
		DISTRO_LINE_AMOUNT,
		DISTRO_LINE_PERCENTAGE,
		DISTRO_LINE_PROJECT_CODE,
		DISTRO_LINE_MOTIVATION_CODE,

		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,
		VW_RGD_COMMITMENT_COMMITMENT_ID,
		VW_RGD_COMMITMENT_CONSTITUENT_ID,
		VW_RGD_COMMITMENT_AUTO_PAY,
		VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
		VW_RGD_COMMITMENT_AMOUNT_TOTAL,
		VW_RGD_COMMITMENT_CURRENCY_CODE,
		VW_RGD_COMMITMENT_FREQUENCY,
		VW_RGD_COMMITMENT_START_DATE,
		VW_RGD_COMMITMENT_END_DATE,
		VW_RGD_COMMITMENT_STATUS,
		VW_RGD_COMMITMENT_COMMENTS,
		VW_RGD_COMMITMENT_CREATE_DATE,
		VW_RGD_COMMITMENT_UPDATE_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_RGD_COMMITMENT_CHECK_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
		VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_RGD_DISTRO_LINE_AMOUNT,
		VW_RGD_DISTRO_LINE_PERCENTAGE,
		VW_RGD_DISTRO_LINE_PROJECT_CODE,
		VW_RGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_CONSTITUENTS_RELATIONSHIPS
	LEFT JOIN VW_GIFTS_DISTRIBUTIONS ON CONSTITUENT_CONSTITUENT_ID = GIFT_CONSTITUENT_ID
;



-- *********************************************************************************************************************
--
-- Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY;
CREATE VIEW VW_AUDITHISTORY
AS
	SELECT
		AUDIT.AUDIT_ID AS AUDIT_AUDIT_ID,
		AUDIT.DATE AS AUDIT_DATE,
		AUDIT.USER AS AUDIT_USER,
		AUDIT.AUDIT_TYPE AS AUDIT_AUDIT_TYPE,
		AUDIT.DESCRIPTION AS AUDIT_DESCRIPTION,
		AUDIT.ENTITY_TYPE AS AUDIT_ENTITY_TYPE,
		AUDIT.OBJECT_ID AS AUDIT_OBJECT_ID,
		AUDIT.CONSTITUENT_ID AS AUDIT_CONSTITUENT_ID,
		AUDIT.SITE_NAME AS AUDIT_SITE_NAME
	FROM AUDIT
;


-- *********************************************************************************************************************
--
-- Address Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_ADDRESSES;
CREATE VIEW VW_AUDITHISTORY_ADDRESSES
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		ADDRESS.CONSTITUENT_ID AS ADDRESS_CONSTITUENT_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE
	FROM VW_AUDITHISTORY
	LEFT JOIN ADDRESS ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = ADDRESS.ADDRESS_ID
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'address'
;


-- *********************************************************************************************************************
--
-- Constituents Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_CONSTITUENTS;
CREATE VIEW VW_AUDITHISTORY_CONSTITUENTS
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID,
		VW_CONSTITUENTS.CONSTITUENT_ACCOUNT_NUMBER,
 		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ROLE,
		VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_CREATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_FIRST_NAME,
 		VW_CONSTITUENTS.CONSTITUENT_DONOR_PROFILE,
		VW_CONSTITUENTS.CONSTITUENT_LAST_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LEGAL_NAME,
		VW_CONSTITUENTS.CONSTITUENT_LOGIN_ID,
		VW_CONSTITUENTS.CONSTITUENT_MARITAL_STATUS,
		VW_CONSTITUENTS.CONSTITUENT_MIDDLE_NAME,
		VW_CONSTITUENTS.CONSTITUENT_NAICS_CODE,
		VW_CONSTITUENTS.CONSTITUENT_ORGANIZATION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_PREFERRED_PHONE_TYPE,
		VW_CONSTITUENTS.CONSTITUENT_RECOGNITION_NAME,
		VW_CONSTITUENTS.CONSTITUENT_SUFFIX,
		VW_CONSTITUENTS.CONSTITUENT_TITLE,
		VW_CONSTITUENTS.CONSTITUENT_UPDATE_DATE,
		VW_CONSTITUENTS.CONSTITUENT_SITE_NAME,

		-- Current Address
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_ID,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_TYPE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ACTIVATION_STATUS,
		VW_CONSTITUENTS.ADDRESS_CURRENT_EFFECTIVE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_1,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_2,
		VW_CONSTITUENTS.ADDRESS_CURRENT_ADDRESS_LINE_3,
		VW_CONSTITUENTS.ADDRESS_CURRENT_CITY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_STATE_PROVINCE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_COUNTRY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_POSTAL_CODE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_COMMENT,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_END_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_START_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_TEMPORARY_END_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_TEMPORARY_START_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_CREATE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_UPDATE_DATE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_INACTIVE,
		VW_CONSTITUENTS.ADDRESS_CURRENT_IS_PRIMARY,
		VW_CONSTITUENTS.ADDRESS_CURRENT_UNDELIVERABLE
	FROM VW_AUDITHISTORY
	LEFT JOIN VW_CONSTITUENTS ON VW_CONSTITUENTS.CONSTITUENT_CONSTITUENT_ID = VW_AUDITHISTORY.AUDIT_OBJECT_ID
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'CONSTITUENT'
;


-- *********************************************************************************************************************
--
-- Email Addresses Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_EMAILADDRESSES;
CREATE VIEW VW_AUDITHISTORY_EMAILADDRESSES
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		EMAIL.CONSTITUENT_ID AS EMAIL_CONSTITUENT_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY
	FROM VW_AUDITHISTORY
	LEFT JOIN EMAIL ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = EMAIL.EMAIL_ID
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'email'
;


-- *********************************************************************************************************************
--
-- Gift Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_GIFTS;
CREATE VIEW VW_AUDITHISTORY_GIFTS
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		GIFT_CONSTITUENT_ID,
		GIFT_GIFT_ID,
		GIFT_AMOUNT,
		GIFT_CURRENCY_CODE,
		GIFT_DONATION_DATE,
		GIFT_POSTMARK_DATE,
		GIFT_COMMENTS,
		GIFT_TRANSACTIONDATE,
		GIFT_GIFT_STATUS,
		GIFT_GIFT_TYPE,
		GIFT_AVS_MESSAGE,
		GIFT_DEDUCTIBLE_AMOUNT,
		GIFT_ENTRY_TYPE,
		GIFT_ORIGINAL_GIFT_ID,
		GIFT_PAYMENT_MESSAGE,
		GIFT_PAYMENT_STATUS,
		GIFT_POSTED,
		GIFT_POSTED_DATE,
		GIFT_PAYMENT_TXREFNUM,
		GIFT_ADDRESS_ID,
		GIFT_PAYMENT_SOURCE_ID,
		GIFT_PHONE_ID,
		GIFT_CREATE_DATE,
		GIFT_UPDATE_DATE,
		GIFT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		GIFT_PAYMENT_SOURCE_INACTIVE,
		GIFT_PAYMENT_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		GIFT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		GIFT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		GIFT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		GIFT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		GIFT_CHECK_NUMBER,
		GIFT_AUTH_CODE,
		GIFT_PAYMENT_ADDRESS_IS_PRIMARY,
		GIFT_PAYMENT_ADDRESS_UNDELIVERABLE,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		GIFT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		GIFT_PAYMENT_ADDRESS_CITY,
		GIFT_PAYMENT_ADDRESS_STATE_PROVINCE,
		GIFT_PAYMENT_ADDRESS_POSTAL_CODE,
		GIFT_PAYMENT_ADDRESS_COUNTRY,
		GIFT_PAYMENT_PHONE_NUMBER,
		GIFT_PAYMENT_PHONE_IS_PRIMARY,
		GIFT_PAYMENT_PHONE_UNDELIVERABLE,
		GIFT_PAYMENT_PHONE_INACTIVE,

		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CONSTITUENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMITMENT_ID,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_RECURRING,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_PER_GIFT,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_AMOUNT_TOTAL,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_CURRENCY_CODE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_STATUS,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_FREQUENCY,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PLEDGE_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_PROJECTED_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_START_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_END_DATE,
		VW_PLEDGES_DISTRIBUTIONS_COMMITMENT_COMMENTS,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_DISTRO_LINE_ID,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_AMOUNT,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PERCENTAGE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_PROJECT_CODE,
		VW_PLEDGES_DISTRIBUTIONS_DISTRO_LINE_MOTIVATION_CODE,
		VW_RGD_COMMITMENT_COMMITMENT_ID,
		VW_RGD_COMMITMENT_CONSTITUENT_ID,
		VW_RGD_COMMITMENT_AUTO_PAY,
		VW_RGD_COMMITMENT_AMOUNT_PER_GIFT,
		VW_RGD_COMMITMENT_AMOUNT_TOTAL,
		VW_RGD_COMMITMENT_CURRENCY_CODE,
		VW_RGD_COMMITMENT_FREQUENCY,
		VW_RGD_COMMITMENT_START_DATE,
		VW_RGD_COMMITMENT_END_DATE,
		VW_RGD_COMMITMENT_STATUS,
		VW_RGD_COMMITMENT_COMMENTS,
		VW_RGD_COMMITMENT_CREATE_DATE,
		VW_RGD_COMMITMENT_UPDATE_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		VW_RGD_COMMITMENT_CHECK_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_CITY,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		VW_RGD_COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_NUMBER,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_IS_PRIMARY,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_UNDELIVERABLE,
		VW_RGD_COMMITMENT_PAYMENT_PHONE_INACTIVE,
		VW_RGD_DISTRO_LINE_DISTRO_LINE_ID,
		VW_RGD_DISTRO_LINE_AMOUNT,
		VW_RGD_DISTRO_LINE_PERCENTAGE,
		VW_RGD_DISTRO_LINE_PROJECT_CODE,
		VW_RGD_DISTRO_LINE_MOTIVATION_CODE
	FROM VW_AUDITHISTORY
	LEFT JOIN VW_GIFTS ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = VW_GIFTS.GIFT_GIFT_ID
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'gift'
;


-- *********************************************************************************************************************
--
-- Payment Method Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_PAYMENTMETHODS;
CREATE VIEW VW_AUDITHISTORY_PAYMENTMETHODS
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		PAYMENT_SOURCE_PAYMENT_SOURCE_ID,
		PAYMENT_SOURCE_CONSTITUENT_ID,
		PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		PAYMENT_SOURCE_INACTIVE,
		PAYMENT_SOURCE_PAYMENT_TYPE,
		PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		PAYMENT_SOURCE_ACH_HOLDER_NAME,
		PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		PAYMENT_SOURCE_ADDRESS_IS_PRIMARY,
		PAYMENT_SOURCE_ADDRESS_UNDELIVERABLE,
		PAYMENT_SOURCE_ADDRESS_INACTIVE,
		PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_1,
		PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_2,
		PAYMENT_SOURCE_ADDRESS_ADDRESS_LINE_3,
		PAYMENT_SOURCE_ADDRESS_CITY,
		PAYMENT_SOURCE_ADDRESS_STATE_PROVINCE,
		PAYMENT_SOURCE_ADDRESS_POSTAL_CODE,
		PAYMENT_SOURCE_ADDRESS_COUNTRY,
		PAYMENT_SOURCE_PHONE_NUMBER,
		PAYMENT_SOURCE_PHONE_IS_PRIMARY,
		PAYMENT_SOURCE_PHONE_UNDELIVERABLE,
		PAYMENT_SOURCE_PHONE_INACTIVE
	FROM VW_AUDITHISTORY
	LEFT JOIN VW_PAYMENTMETHODS ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = VW_PAYMENTMETHODS.PAYMENT_SOURCE_PAYMENT_SOURCE_ID
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'paymentsource'
;



-- *********************************************************************************************************************
--
-- Phone Number Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_PHONENUMBERS;
CREATE VIEW VW_AUDITHISTORY_PHONENUMBERS
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		PHONE.CONSTITUENT_ID AS PHONE_CONSTITUENT_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY
	FROM VW_AUDITHISTORY
	LEFT JOIN PHONE ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = PHONE.PHONE_ID
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'phone'
;


-- *********************************************************************************************************************
--
-- Pledge Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_PLEDGES;
CREATE VIEW VW_AUDITHISTORY_PLEDGES
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		-- Pledge Number Information
		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_RECURRING,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_STATUS,
		COMMITMENT_FREQUENCY,
		COMMITMENT_PLEDGE_DATE,
		COMMITMENT_PROJECTED_DATE,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_COMMENTS
	FROM VW_AUDITHISTORY
	LEFT JOIN VW_PLEDGES ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = VW_PLEDGES.COMMITMENT_COMMITMENT_ID
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'pledge'
;



-- *********************************************************************************************************************
--
-- Recurring Gift Audit History View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_AUDITHISTORY_RECURRINGGIFTS;
CREATE VIEW VW_AUDITHISTORY_RECURRINGGIFTS
AS
	SELECT
		VW_AUDITHISTORY.AUDIT_AUDIT_ID,
		VW_AUDITHISTORY.AUDIT_DATE,
		VW_AUDITHISTORY.AUDIT_USER,
		VW_AUDITHISTORY.AUDIT_AUDIT_TYPE,
		VW_AUDITHISTORY.AUDIT_DESCRIPTION,
		VW_AUDITHISTORY.AUDIT_ENTITY_TYPE,
		VW_AUDITHISTORY.AUDIT_OBJECT_ID,
		VW_AUDITHISTORY.AUDIT_CONSTITUENT_ID,
		VW_AUDITHISTORY.AUDIT_SITE_NAME,

		-- Recurring Gift Information
		COMMITMENT_COMMITMENT_ID,
		COMMITMENT_CONSTITUENT_ID,
		COMMITMENT_AUTO_PAY,
		COMMITMENT_AMOUNT_PER_GIFT,
		COMMITMENT_AMOUNT_TOTAL,
		COMMITMENT_CURRENCY_CODE,
		COMMITMENT_FREQUENCY,
		COMMITMENT_START_DATE,
		COMMITMENT_END_DATE,
		COMMITMENT_STATUS,
		COMMITMENT_COMMENTS,
		COMMITMENT_CREATE_DATE,
		COMMITMENT_UPDATE_DATE,
		COMMITMENT_PAYMENT_SOURCE_PAYMENT_PROFILE_DESCRIPTION,
		COMMITMENT_PAYMENT_SOURCE_INACTIVE,
		COMMITMENT_PAYMENT_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_TYPE,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION,
		COMMITMENT_PAYMENT_SOURCE_CREDIT_CARD_EXPIRATION_DATE,
		COMMITMENT_PAYMENT_SOURCE_ACH_HOLDER_NAME,
		COMMITMENT_PAYMENT_SOURCE_ACH_ROUTING_NUMBER,
		COMMITMENT_PAYMENT_SOURCE_LAST_FOUR_DIGITS,
		COMMITMENT_CHECK_NUMBER,
		COMMITMENT_PAYMENT_ADDRESS_IS_PRIMARY,
		COMMITMENT_PAYMENT_ADDRESS_UNDELIVERABLE,
		COMMITMENT_PAYMENT_ADDRESS_INACTIVE,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_1,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_2,
		COMMITMENT_PAYMENT_ADDRESS_ADDRESS_LINE_3,
		COMMITMENT_PAYMENT_ADDRESS_CITY,
		COMMITMENT_PAYMENT_ADDRESS_STATE_PROVINCE,
		COMMITMENT_PAYMENT_ADDRESS_POSTAL_CODE,
		COMMITMENT_PAYMENT_ADDRESS_COUNTRY,
		COMMITMENT_PAYMENT_PHONE_NUMBER
	FROM VW_AUDITHISTORY
	LEFT JOIN VW_RECURRINGGIFTS ON VW_AUDITHISTORY.AUDIT_OBJECT_ID = VW_RECURRINGGIFTS.COMMITMENT_COMMITMENT_ID
	WHERE VW_AUDITHISTORY.AUDIT_ENTITY_TYPE = 'recurring gift'
;


-- *********************************************************************************************************************
--
-- Touch Points View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_TOUCHPOINTS;
CREATE VIEW VW_TOUCHPOINTS
AS
	SELECT
		COMMUNICATION_HISTORY.COMMUNICATION_HISTORY_ID AS COMMUNICATION_HISTORY_COMMUNICATION_HISTORY_ID,
		COMMUNICATION_HISTORY.COMMUNICATION_TYPE AS COMMUNICATION_HISTORY_COMMUNICATION_TYPE,
		COMMUNICATION_HISTORY.ENTRY_TYPE AS COMMUNICATION_HISTORY_ENTRY_TYPE,
		COMMUNICATION_HISTORY.RECORD_DATE AS COMMUNICATION_HISTORY_RECORD_DATE,
		COMMUNICATION_HISTORY.COMMENTS AS COMMUNICATION_HISTORY_COMMENTS,
		COMMUNICATION_HISTORY.SYSTEM_GENERATED AS COMMUNICATION_HISTORY_SYSTEM_GENERATED,
		COMMUNICATION_HISTORY.CREATE_DATE AS COMMUNICATION_HISTORY_CREATE_DATE,
		COMMUNICATION_HISTORY.UPDATE_DATE AS COMMUNICATION_HISTORY_UPDATE_DATE,
		COMMUNICATION_HISTORY.PLEDGE_ID AS COMMUNICATION_HISTORY_PLEDGE_ID,
		COMMUNICATION_HISTORY.RECURRING_GIFT_ID AS COMMUNICATION_HISTORY_RECURRING_GIFT_ID,
		COMMUNICATION_HISTORY.GIFT_ID AS COMMUNICATION_HISTORY_GIFT_ID,
		COMMUNICATION_HISTORY.CONSTITUENT_ID AS COMMUNICATION_HISTORY_CONSTITUENT_ID,
		COMMUNICATION_HISTORY.ADDRESS_ID AS COMMUNICATION_HISTORY_ADDRESS_ID,
		COMMUNICATION_HISTORY.PHONE_ID AS COMMUNICATION_HISTORY_PHONE_ID,
		COMMUNICATION_HISTORY.EMAIL_ID AS COMMUNICATION_HISTORY_EMAIL_ID,
		GETCUSTOMFIELD(COMMUNICATION_HISTORY.COMMUNICATION_HISTORY_ID, 'communicationhistory', 'assignedTo') AS COMMUNICATION_HISTORY_ASSIGNED_TO,
		GETCUSTOMFIELD(COMMUNICATION_HISTORY.COMMUNICATION_HISTORY_ID, 'communicationhistory', 'recordedBy') AS COMMUNICATION_HISTORY_RECORDED_BY
	FROM COMMUNICATION_HISTORY
;


-- *********************************************************************************************************************
--
-- Touch Points & Constituents View
--
-- *********************************************************************************************************************
DROP VIEW IF EXISTS VW_TOUCHPOINTS_CONSTITUENT_INFORMATION;
CREATE VIEW VW_TOUCHPOINTS_CONSTITUENT_INFORMATION
AS
	SELECT
		COMMUNICATION_HISTORY_COMMUNICATION_HISTORY_ID,
		COMMUNICATION_HISTORY_COMMUNICATION_TYPE,
		COMMUNICATION_HISTORY_ENTRY_TYPE,
		COMMUNICATION_HISTORY_RECORD_DATE,
		COMMUNICATION_HISTORY_COMMENTS,
		COMMUNICATION_HISTORY_SYSTEM_GENERATED,
		COMMUNICATION_HISTORY_CREATE_DATE,
		COMMUNICATION_HISTORY_UPDATE_DATE,
		COMMUNICATION_HISTORY_PLEDGE_ID,
		COMMUNICATION_HISTORY_RECURRING_GIFT_ID,
		COMMUNICATION_HISTORY_GIFT_ID,
		COMMUNICATION_HISTORY_CONSTITUENT_ID,
		COMMUNICATION_HISTORY_ADDRESS_ID,
		COMMUNICATION_HISTORY_PHONE_ID,
		COMMUNICATION_HISTORY_EMAIL_ID,
		COMMUNICATION_HISTORY_ASSIGNED_TO,
		COMMUNICATION_HISTORY_RECORDED_BY,

		-- Constituent Information
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_CONSTITUENT_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_ACCOUNT_NUMBER,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_CONSTITUENT_ROLE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_CONSTITUENT_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_CREATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_FIRST_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_DONOR_PROFILE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_LAST_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_LEGAL_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_LOGIN_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_MARITAL_STATUS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_MIDDLE_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_NAICS_CODE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_ORGANIZATION_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_PREFERRED_PHONE_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_RECOGNITION_NAME,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_SUFFIX,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_TITLE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_UPDATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_SITE_NAME,

		-- Current Address
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ADDRESS_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ADDRESS_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ACTIVATION_STATUS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_EFFECTIVE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ADDRESS_LINE_1,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ADDRESS_LINE_2,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_ADDRESS_LINE_3,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_CITY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_STATE_PROVINCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_COUNTRY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_POSTAL_CODE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_COMMENT,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_SEASONAL_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_SEASONAL_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_TEMPORARY_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_TEMPORARY_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_CREATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_UPDATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_INACTIVE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_IS_PRIMARY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CURRENT_UNDELIVERABLE,

		-- Primary Address Information
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ADDRESS_ID AS ADDRESS_PRIMARY_ADDRESS_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ADDRESS_TYPE AS ADDRESS_PRIMARY_ADDRESS_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ACTIVATION_STATUS AS ADDRESS_PRIMARY_ACTIVATION_STATUS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_EFFECTIVE_DATE AS ADDRESS_PRIMARY_EFFECTIVE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ADDRESS_LINE_1 AS ADDRESS_PRIMARY_ADDRESS_LINE_1,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ADDRESS_LINE_2 AS ADDRESS_PRIMARY_ADDRESS_LINE_2,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_ADDRESS_LINE_3 AS ADDRESS_PRIMARY_ADDRESS_LINE_3,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CITY AS ADDRESS_PRIMARY_CITY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_STATE_PROVINCE AS ADDRESS_PRIMARY_STATE_PROVINCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_COUNTRY AS ADDRESS_PRIMARY_COUNTRY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_POSTAL_CODE AS ADDRESS_PRIMARY_POSTAL_CODE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_RECEIVE_CORRESPONDENCE AS ADDRESS_PRIMARY_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_COMMENT AS ADDRESS_PRIMARY_COMMENT,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_SEASONAL_END_DATE AS ADDRESS_PRIMARY_SEASONAL_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_SEASONAL_START_DATE AS ADDRESS_PRIMARY_SEASONAL_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_SEASONAL_END_DATE_DISPLAY AS ADDRESS_PRIMARY_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_SEASONAL_START_DATE_DISPLAY AS ADDRESS_PRIMARY_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_TEMPORARY_END_DATE AS ADDRESS_PRIMARY_TEMPORARY_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_TEMPORARY_START_DATE AS ADDRESS_PRIMARY_TEMPORARY_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_CREATE_DATE AS ADDRESS_PRIMARY_CREATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_UPDATE_DATE AS ADDRESS_PRIMARY_UPDATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_INACTIVE AS ADDRESS_PRIMARY_INACTIVE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_IS_PRIMARY AS ADDRESS_PRIMARY_IS_PRIMARY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.ADDRESS_UNDELIVERABLE AS ADDRESS_PRIMARY_UNDELIVERABLE,

		-- Primary Email Information
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_EMAIL_ID AS EMAIL_PRIMARY_EMAIL_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_EMAIL_TYPE AS EMAIL_PRIMARY_EMAIL_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_ACTIVATION_STATUS AS EMAIL_PRIMARY_ACTIVATION_STATUS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_EFFECTIVE_DATE AS EMAIL_PRIMARY_EFFECTIVE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_SEASONAL_END_DATE AS EMAIL_PRIMARY_SEASONAL_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_SEASONAL_START_DATE AS EMAIL_PRIMARY_SEASONAL_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_SEASONAL_START_DATE_DISPLAY AS EMAIL_PRIMARY_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_SEASONAL_END_DATE_DISPLAY AS EMAIL_PRIMARY_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_TEMPORARY_START_DATE AS EMAIL_PRIMARY_TEMPORARY_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_TEMPORARY_END_DATE AS EMAIL_PRIMARY_TEMPORARY_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_EMAIL_ADDRESS AS EMAIL_PRIMARY_EMAIL_ADDRESS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_EMAIL_DISPLAY AS EMAIL_PRIMARY_EMAIL_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_RECEIVE_CORRESPONDENCE AS EMAIL_PRIMARY_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_COMMENT AS EMAIL_PRIMARY_COMMENT,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_CREATE_DATE AS EMAIL_PRIMARY_CREATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_UPDATE_DATE AS EMAIL_PRIMARY_UPDATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_INACTIVE AS EMAIL_PRIMARY_INACTIVE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_UNDELIVERABLE AS EMAIL_PRIMARY_UNDELIVERABLE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.EMAIL_IS_PRIMARY AS EMAIL_PRIMARY_IS_PRIMARY,

		-- Primary Phone Information
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_PHONE_ID AS PHONE_PRIMARY_PHONE_ID,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_PHONE_TYPE AS PHONE_PRIMARY_PHONE_TYPE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_ACTIVATION_STATUS AS PHONE_PRIMARY_ACTIVATION_STATUS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_EFFECTIVE_DATE AS PHONE_PRIMARY_EFFECTIVE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_SEASONAL_END_DATE AS PHONE_PRIMARY_SEASONAL_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_SEASONAL_START_DATE AS PHONE_PRIMARY_SEASONAL_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_SEASONAL_START_DATE_DISPLAY AS PHONE_PRIMARY_SEASONAL_START_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_SEASONAL_END_DATE_DISPLAY AS PHONE_PRIMARY_SEASONAL_END_DATE_DISPLAY,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_TEMPORARY_START_DATE AS PHONE_PRIMARY_TEMPORARY_START_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_TEMPORARY_END_DATE AS PHONE_PRIMARY_TEMPORARY_END_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_NUMBER AS PHONE_PRIMARY_NUMBER,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_PROVIDER AS PHONE_PRIMARY_PROVIDER,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_SMS AS PHONE_PRIMARY_SMS,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_RECEIVE_CORRESPONDENCE AS PHONE_PRIMARY_RECEIVE_CORRESPONDENCE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_RECEIVE_CORRESPONDENCE_TEXT AS PHONE_PRIMARY_RECEIVE_CORRESPONDENCE_TEXT,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_COMMENT AS PHONE_PRIMARY_COMMENT,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_CREATE_DATE AS PHONE_PRIMARY_CREATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_UPDATE_DATE AS PHONE_PRIMARY_UPDATE_DATE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_INACTIVE AS PHONE_PRIMARY_INACTIVE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_UNDELIVERABLE AS PHONE_PRIMARY_UNDELIVERABLE,
		VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.PHONE_IS_PRIMARY AS PHONE_PRIMARY_IS_PRIMARY,

		-- Address Information
		ADDRESS.ADDRESS_ID AS ADDRESS_ADDRESS_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[addressType]', ADDRESS_TYPE.FIELD_VALUE) AS ADDRESS_ADDRESS_TYPE,
		ADDRESS.ACTIVATION_STATUS AS ADDRESS_ACTIVATION_STATUS,
		ADDRESS.EFFECTIVE_DATE AS ADDRESS_EFFECTIVE_DATE,
		ADDRESS.ADDRESS_LINE_1 AS ADDRESS_ADDRESS_LINE_1,
		ADDRESS.ADDRESS_LINE_2 AS ADDRESS_ADDRESS_LINE_2,
		ADDRESS.ADDRESS_LINE_3 AS ADDRESS_ADDRESS_LINE_3,
		ADDRESS.CITY AS ADDRESS_CITY,
		ADDRESS.STATE_PROVINCE AS ADDRESS_STATE_PROVINCE,
		ADDRESS.COUNTRY AS ADDRESS_COUNTRY,
		ADDRESS.POSTAL_CODE AS ADDRESS_POSTAL_CODE,
		ADDRESS.RECEIVE_CORRESPONDENCE AS ADDRESS_RECEIVE_CORRESPONDENCE,
		ADDRESS.COMMENT AS ADDRESS_COMMENT,
		ADDRESS.SEASONAL_END_DATE AS ADDRESS_SEASONAL_END_DATE,
		ADDRESS.SEASONAL_START_DATE AS ADDRESS_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_END_DATE), '-', DAY(ADDRESS.SEASONAL_END_DATE)) AS ADDRESS_SEASONAL_END_DATE_DISPLAY,
		CONCAT(MONTHNAME(ADDRESS.SEASONAL_START_DATE), '-', DAY(ADDRESS.SEASONAL_START_DATE)) AS ADDRESS_SEASONAL_START_DATE_DISPLAY,
		ADDRESS.TEMPORARY_END_DATE AS ADDRESS_TEMPORARY_END_DATE,
		ADDRESS.TEMPORARY_START_DATE AS ADDRESS_TEMPORARY_START_DATE,
		ADDRESS.CREATE_DATE AS ADDRESS_CREATE_DATE,
		ADDRESS.UPDATE_DATE AS ADDRESS_UPDATE_DATE,
		ADDRESS.INACTIVE AS ADDRESS_INACTIVE,
		ADDRESS.IS_PRIMARY AS ADDRESS_IS_PRIMARY,
		ADDRESS.UNDELIVERABLE AS ADDRESS_UNDELIVERABLE,

		-- Email Information
		EMAIL.EMAIL_ID AS EMAIL_EMAIL_ID,
		EMAIL.CONSTITUENT_ID AS EMAIL_CONSTITUENT_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[emailType]', EMAIL_TYPES.FIELD_VALUE) AS EMAIL_EMAIL_TYPE,
		EMAIL.ACTIVATION_STATUS AS EMAIL_ACTIVATION_STATUS,
		EMAIL.EFFECTIVE_DATE AS EMAIL_EFFECTIVE_DATE,
		EMAIL.SEASONAL_END_DATE AS EMAIL_SEASONAL_END_DATE,
		EMAIL.SEASONAL_START_DATE AS EMAIL_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_START_DATE), '-', DAY(EMAIL.SEASONAL_START_DATE)) AS EMAIL_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(EMAIL.SEASONAL_END_DATE), '-', DAY(EMAIL.SEASONAL_END_DATE)) AS EMAIL_SEASONAL_END_DATE_DISPLAY,
		EMAIL.TEMPORARY_START_DATE AS EMAIL_TEMPORARY_START_DATE,
		EMAIL.TEMPORARY_END_DATE AS EMAIL_TEMPORARY_END_DATE,
		EMAIL.EMAIL_ADDRESS AS EMAIL_EMAIL_ADDRESS,
		EMAIL.EMAIL_DISPLAY AS EMAIL_EMAIL_DISPLAY,
		EMAIL.RECEIVE_CORRESPONDENCE AS EMAIL_RECEIVE_CORRESPONDENCE,
		EMAIL.COMMENT AS EMAIL_COMMENT,
		EMAIL.CREATE_DATE AS EMAIL_CREATE_DATE,
		EMAIL.UPDATE_DATE AS EMAIL_UPDATE_DATE,
		EMAIL.INACTIVE AS EMAIL_INACTIVE,
		EMAIL.UNDELIVERABLE AS EMAIL_UNDELIVERABLE,
		EMAIL.IS_PRIMARY AS EMAIL_IS_PRIMARY,

		-- Phone Number Information
		PHONE.PHONE_ID AS PHONE_PHONE_ID,
		PHONE.CONSTITUENT_ID AS PHONE_CONSTITUENT_ID,
		GETPICKLISTDISPLAYVALUE('customFieldMap[phoneType]', PHONE_TYPES.FIELD_VALUE) AS PHONE_PHONE_TYPE,
		PHONE.ACTIVATION_STATUS AS PHONE_ACTIVATION_STATUS,
		PHONE.EFFECTIVE_DATE AS PHONE_EFFECTIVE_DATE,
		PHONE.SEASONAL_END_DATE AS PHONE_SEASONAL_END_DATE,
		PHONE.SEASONAL_START_DATE AS PHONE_SEASONAL_START_DATE,
		CONCAT(MONTHNAME(PHONE.SEASONAL_START_DATE), '-', DAY(PHONE.SEASONAL_START_DATE)) AS PHONE_SEASONAL_START_DATE_DISPLAY,
		CONCAT(MONTHNAME(PHONE.SEASONAL_END_DATE), '-', DAY(PHONE.SEASONAL_END_DATE)) AS PHONE_SEASONAL_END_DATE_DISPLAY,
		PHONE.TEMPORARY_START_DATE AS PHONE_TEMPORARY_START_DATE,
		PHONE.TEMPORARY_END_DATE AS PHONE_TEMPORARY_END_DATE,
		PHONE.NUMBER AS PHONE_NUMBER,
		PHONE.PROVIDER AS PHONE_PROVIDER,
		PHONE.SMS AS PHONE_SMS,
		PHONE.RECEIVE_CORRESPONDENCE AS PHONE_RECEIVE_CORRESPONDENCE,
		PHONE.RECEIVE_CORRESPONDENCE_TEXT AS PHONE_RECEIVE_CORRESPONDENCE_TEXT,
		PHONE.COMMENT AS PHONE_COMMENT,
		PHONE.CREATE_DATE AS PHONE_CREATE_DATE,
		PHONE.UPDATE_DATE AS PHONE_UPDATE_DATE,
		PHONE.INACTIVE AS PHONE_INACTIVE,
		PHONE.UNDELIVERABLE AS PHONE_UNDELIVERABLE,
		PHONE.IS_PRIMARY AS PHONE_IS_PRIMARY
	FROM VW_TOUCHPOINTS
	LEFT JOIN VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION ON VW_TOUCHPOINTS.COMMUNICATION_HISTORY_CONSTITUENT_ID = VW_CONSTITUENTS_PRIMARYCONTACTINFORMATION.CONSTITUENT_CONSTITUENT_ID
	-- Address Information
	LEFT JOIN ADDRESS ON VW_TOUCHPOINTS.COMMUNICATION_HISTORY_ADDRESS_ID = ADDRESS.ADDRESS_ID
	LEFT JOIN CUSTOM_FIELD ADDRESS_TYPE ON ADDRESS_TYPE.ENTITY_TYPE = 'address' AND ADDRESS.ADDRESS_ID = ADDRESS_TYPE.ENTITY_ID AND ADDRESS_TYPE.FIELD_NAME = 'addressType'
	-- Phone Information
	LEFT JOIN PHONE ON VW_TOUCHPOINTS.COMMUNICATION_HISTORY_PHONE_ID = PHONE.PHONE_ID
	LEFT JOIN CUSTOM_FIELD AS PHONE_TYPES ON PHONE_TYPES.ENTITY_TYPE = 'phone' AND PHONE_TYPES.ENTITY_ID = PHONE.PHONE_ID AND PHONE_TYPES.FIELD_NAME = 'phoneType'
	-- Email Information
	LEFT JOIN EMAIL ON VW_TOUCHPOINTS.COMMUNICATION_HISTORY_EMAIL_ID = EMAIL.EMAIL_ID
	LEFT JOIN CUSTOM_FIELD AS EMAIL_TYPES ON EMAIL_TYPES.ENTITY_TYPE = 'email' AND EMAIL_TYPES.ENTITY_ID = EMAIL.EMAIL_ID AND EMAIL_TYPES.FIELD_NAME = 'emailType'
;
