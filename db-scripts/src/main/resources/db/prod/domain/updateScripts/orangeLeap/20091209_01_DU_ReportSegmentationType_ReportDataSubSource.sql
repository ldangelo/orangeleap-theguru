INSERT REPORTSEGMENTATIONTYPE_REPORTDATASUBSOURCE
  (reportSegmentationTypes_REPORTSEGMENTATIONTYPE_ID, reportDataSubSource_REPORTSUBSOURCE_ID, REPORTSUBSOURCE_ID, REPORTSEGMENTATIONTYPE_ID)
SELECT DISTINCT
  REPORTSEGMENTATIONTYPE_ID, REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID, REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID, REPORTSEGMENTATIONTYPE_ID
FROM REPORTDATASUBSOURCE
JOIN REPORTFIELDGROUP_REPORTDATASUBSOURCE ON REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID = REPORTFIELDGROUP_REPORTDATASUBSOURCE.reportDataSubSource_REPORTSUBSOURCE_ID
JOIN REPORTFIELD_REPORTFIELDGROUP ON REPORTFIELDGROUP_REPORTDATASUBSOURCE.REPORTFIELDGROUP_REPORTFIELDGROUP_ID = REPORTFIELD_REPORTFIELDGROUP.reportFieldGroup_REPORTFIELDGROUP_ID
JOIN REPORTFIELD ON REPORTFIELD_REPORTFIELDGROUP.fields_REPORTFIELD_ID = REPORTFIELD.REPORTFIELD_ID
JOIN REPORTSEGMENTATIONTYPE ON REPORTSEGMENTATIONTYPE.COLUMN_NAME = 'CONSTITUENT_CONSTITUENT_ID'
WHERE REPORTFIELD.COLUMN_NAME = 'CONSTITUENT_CONSTITUENT_ID' OR REPORTFIELD.PRIMARY_KEYS LIKE CONCAT('%', 'CONSTITUENT_CONSTITUENT_ID', '%')
AND NOT EXISTS
	(SELECT * FROM REPORTSEGMENTATIONTYPE_REPORTDATASUBSOURCE
	 WHERE reportSegmentationTypes_REPORTSEGMENTATIONTYPE_ID = REPORTSEGMENTATIONTYPE_ID
	 AND reportDataSubSource_REPORTSUBSOURCE_ID = REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID
	 AND REPORTSEGMENTATIONTYPE_REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID = REPORTDATASUBSOURCE.REPORTSUBSOURCE_ID
	 AND REPORTSEGMENTATIONTYPE_REPORTDATASUBSOURCE.REPORTSEGMENTATIONTYPE_ID = REPORTSEGMENTATIONTYPE_ID);
